<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"cnovelist.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="一个穷鬼">
<meta property="og:type" content="website">
<meta property="og:title" content="江小月不上頭">
<meta property="og:url" content="https://cnovelist.github.io/page/2/index.html">
<meta property="og:site_name" content="江小月不上頭">
<meta property="og:description" content="一个穷鬼">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="故事开头">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://cnovelist.github.io/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>江小月不上頭</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband">
    <a target="_blank" rel="noopener" href="https://github.com/CNovelist" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    </div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">江小月不上頭</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">有容乃大，无欲则刚</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://cnovelist.github.io/2022/04/03/Linux%E5%9F%BA%E7%A1%80%E5%A4%A7%E5%85%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/yue.jpeg">
      <meta itemprop="name" content="故事开头">
      <meta itemprop="description" content="一个穷鬼">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="江小月不上頭">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/04/03/Linux%E5%9F%BA%E7%A1%80%E5%A4%A7%E5%85%A8/" class="post-title-link" itemprop="url">Linux基础大全</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-04-03 11:36:08" itemprop="dateCreated datePublished" datetime="2022-04-03T11:36:08+08:00">2022-04-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-04-29 18:12:17" itemprop="dateModified" datetime="2022-04-29T18:12:17+08:00">2022-04-29</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%90%8E%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">后端</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%90%8E%E7%AB%AF/%E6%9C%8D%E5%8A%A1%E5%99%A8/" itemprop="url" rel="index"><span itemprop="name">服务器</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="一、系统分区"><a href="#一、系统分区" class="headerlink" title="一、系统分区"></a>一、系统分区</h1><h2 id="1-1-分区类型"><a href="#1-1-分区类型" class="headerlink" title="1.1 分区类型"></a>1.1 分区类型</h2><h3 id="1-1-1-主分区"><a href="#1-1-1-主分区" class="headerlink" title="1.1.1 主分区"></a>1.1.1 主分区</h3><ul>
<li>最多只能有4个</li>
</ul>
<h3 id="1-1-2-扩展分区"><a href="#1-1-2-扩展分区" class="headerlink" title="1.1.2 扩展分区"></a>1.1.2 扩展分区</h3><ul>
<li>最多只能有1个</li>
<li>主分区加扩展分区最多有4个</li>
<li>不能写入数据，只能包含逻辑分区</li>
</ul>
<h3 id="1-1-3-逻辑分区"><a href="#1-1-3-逻辑分区" class="headerlink" title="1.1.3 逻辑分区"></a>1.1.3 逻辑分区</h3><ul>
<li>可以写入数据</li>
</ul>
<h2 id="1-2-格式化"><a href="#1-2-格式化" class="headerlink" title="1.2 格式化"></a>1.2 格式化</h2><ul>
<li>又称逻辑格式化</li>
<li>目的是在硬盘中写入文件系统</li>
<li>文件系统有：FAT16、FAT32、NTFS、EXT2、EXT3、EXT4（默认）等</li>
</ul>
<h2 id="1-3-硬件设备名"><a href="#1-3-硬件设备名" class="headerlink" title="1.3 硬件设备名"></a>1.3 硬件设备名</h2><div class="table-container">
<table>
<thead>
<tr>
<th>硬件</th>
<th>设备文件名</th>
</tr>
</thead>
<tbody>
<tr>
<td>IDE硬盘</td>
<td>/dev/hd[a-d]</td>
</tr>
<tr>
<td>SCSI/SATA/USB硬盘</td>
<td>/dev/sd[a-p]</td>
</tr>
<tr>
<td>光驱</td>
<td>/dev/cdrom或/dev/sr0</td>
</tr>
<tr>
<td>软盘</td>
<td>/dev/fd[0-1]</td>
</tr>
<tr>
<td>打印机（25针）</td>
<td>/dev/lp[0-2]</td>
</tr>
<tr>
<td>打印机（USB）</td>
<td>/dev/usb/lp[0-15]</td>
</tr>
<tr>
<td>鼠标</td>
<td>/dev/mouse</td>
</tr>
</tbody>
</table>
</div>
<h2 id="1-4-分区表示"><a href="#1-4-分区表示" class="headerlink" title="1.4 分区表示"></a>1.4 分区表示</h2><ul>
<li>不管如何分区，1、2、3、4都用于主分区，第一个逻辑分区都是从5开始</li>
</ul>
<img src="/2022/04/03/Linux%E5%9F%BA%E7%A1%80%E5%A4%A7%E5%85%A8/fenqu.png" class="" title="fenqu">
<h2 id="1-5-挂载"><a href="#1-5-挂载" class="headerlink" title="1.5 挂载"></a>1.5 挂载</h2><h3 id="1-5-1-必备分区"><a href="#1-5-1-必备分区" class="headerlink" title="1.5.1 必备分区"></a>1.5.1 必备分区</h3><ul>
<li>/ （根分区）</li>
<li>swap分区（交换分区，内存2倍，不超过2GB）</li>
</ul>
<h3 id="1-5-2-推荐分区"><a href="#1-5-2-推荐分区" class="headerlink" title="1.5.2 推荐分区"></a>1.5.2 推荐分区</h3><ul>
<li>/boot（启动分区，200MB，默认是sda1）</li>
</ul>
<h2 id="1-6-文件系统结构"><a href="#1-6-文件系统结构" class="headerlink" title="1.6 文件系统结构"></a>1.6 文件系统结构</h2><img src="/2022/04/03/Linux%E5%9F%BA%E7%A1%80%E5%A4%A7%E5%85%A8/file.png" class="" title="file">
<ul>
<li>Linux目录可以放在不同的系统分区中</li>
</ul>
<h2 id="1-7-小结"><a href="#1-7-小结" class="headerlink" title="1.7 小结"></a>1.7 小结</h2><ul>
<li>分区：把大硬盘分为小的逻辑分区</li>
<li>格式化：写入文件系统</li>
<li>分区设备文件名：给每个分区定义设备文件名</li>
<li>挂载：给每个分区分配挂载点（挂载点必须是空目录，挂载后分区才能正常使用）</li>
</ul>
<h1 id="二、Linux命令"><a href="#二、Linux命令" class="headerlink" title="二、Linux命令"></a>二、Linux命令</h1><h2 id="2-1-文件目录"><a href="#2-1-文件目录" class="headerlink" title="2.1 文件目录"></a>2.1 文件目录</h2><div class="table-container">
<table>
<thead>
<tr>
<th>目录名称</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>.</td>
<td>代表当前目录</td>
</tr>
<tr>
<td>..</td>
<td>代表上一级目录</td>
</tr>
<tr>
<td>-</td>
<td>代表前一个工作目录</td>
</tr>
<tr>
<td>~</td>
<td>代表[目前用户身份]所在的家目录</td>
</tr>
</tbody>
</table>
</div>
<h2 id="2-2-文件处理命令"><a href="#2-2-文件处理命令" class="headerlink" title="2.2 文件处理命令"></a>2.2 文件处理命令</h2><h3 id="2-2-1-命令列表"><a href="#2-2-1-命令列表" class="headerlink" title="2.2.1 命令列表"></a>2.2.1 命令列表</h3><ul>
<li>以下命令执行权限为<strong>所有用户</strong></li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>命令</th>
<th>选项</th>
<th style="text-align:left">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>ls</td>
<td>-ald [文件/目录]</td>
<td style="text-align:left">a：显示目录中全部文件（包括隐藏文件）<br/>-l：详细信息显示<br/>-d：查看目录属性<br/>-i：查看i节点<br/>显示目录文件信息<br/>所在位置/bin/mkdir</td>
</tr>
<tr>
<td>mkdir</td>
<td>-p</td>
<td style="text-align:left">-p：递归创建<br/>创建新目录</td>
</tr>
<tr>
<td>cd</td>
<td></td>
<td style="text-align:left"></td>
</tr>
<tr>
<td>pwd</td>
<td></td>
<td style="text-align:left">显示当前目录<br/>所在位置/bin/pwd</td>
</tr>
<tr>
<td>rmdir</td>
<td></td>
<td style="text-align:left">删除空目录</td>
</tr>
<tr>
<td>cp</td>
<td>-rp [原文件/目录] [目标目录]</td>
<td style="text-align:left">-r：表示复制目录<br/>-p：表示保留文件属性<br/>复制文件或目录<br/>所在位置/bin/cp</td>
</tr>
<tr>
<td>mv</td>
<td>[原文件或目录] [目标目录]</td>
<td style="text-align:left">剪切文件、改名<br/>所在位置/bin/mv</td>
</tr>
<tr>
<td>rm</td>
<td>-rf</td>
<td style="text-align:left">-r：表示删除目录<br/>-f：表示强制执行</td>
</tr>
<tr>
<td>touch</td>
<td>[文件名]</td>
<td style="text-align:left">创建空文件<br/>所在位置/bin/touch，文件名不推荐加空格</td>
</tr>
<tr>
<td>cat</td>
<td>-n [文件名]</td>
<td style="text-align:left">-n：表示显示行号<br/>显示文件内容</td>
</tr>
<tr>
<td>tac</td>
<td></td>
<td style="text-align:left">反向显示文件内容</td>
</tr>
<tr>
<td>more</td>
<td></td>
<td style="text-align:left">按f/空格翻页<br/>按Enter换行<br/>按q退出<br/>分页显示文件内容<br/>所在位置/bin/more</td>
</tr>
<tr>
<td>less</td>
<td></td>
<td style="text-align:left">按PgUp向上翻页<br/>/+搜索名称进行内容搜索（继续按n可以向下查找）<br/>分页显示文件内容（可以向上翻页）<br/>所在位置/usr/bin/less</td>
</tr>
<tr>
<td>head</td>
<td>-n [文件名]</td>
<td style="text-align:left">-n：指定行数<br/>显示文件前几行，默认显示前世行<br/>所在位置/uer/bin/head</td>
</tr>
<tr>
<td>tail</td>
<td>-nf</td>
<td style="text-align:left">-n：指定行数<br/>-f：表示动态显示文件末尾内容<br/>显示文件后几行，默认显示后10行<br/>所在位置/usr/bin/tail</td>
</tr>
<tr>
<td>ln</td>
<td></td>
<td style="text-align:left">-s [原文件] [目标文件]<br/>生成链接文件<br/>所在位置/bin/ln</td>
</tr>
</tbody>
</table>
</div>
<h3 id="2-2-2-示例"><a href="#2-2-2-示例" class="headerlink" title="2.2.2 示例"></a>2.2.2 示例</h3><ul>
<li>ls -ld</li>
<li>mkdir -p /tmp/a/b</li>
<li>cd ..（返回上一目录）/cd [绝对路径/相对路径]</li>
<li>pwd</li>
<li>rmdir /tmp/a/b</li>
<li>cp -r /tmp/a/b /root（将b目录复制到root目录下）</li>
<li>mv /tmp/a/b /root/c（将b剪切到root目录并改名为c）</li>
<li>touch a.list</li>
<li>cat /etc/issue</li>
<li>more /etc/services</li>
<li>less /etc/services</li>
<li>head -n 20 /etc/services</li>
<li>tail -n 18 /etc/services</li>
<li>ln -s /etc/issue /tmp/issue.soft</li>
</ul>
<h2 id="2-3-权限管理命令"><a href="#2-3-权限管理命令" class="headerlink" title="2.3 权限管理命令"></a>2.3 权限管理命令</h2><h3 id="2-3-1-命令列表"><a href="#2-3-1-命令列表" class="headerlink" title="2.3.1 命令列表"></a>2.3.1 命令列表</h3><ul>
<li>以下命令执行权限为<strong>所有用户</strong></li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>命令</th>
<th>选项</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>chmod</td>
<td>[{ugoa}{+-=}{rwx}] [文件或目录]或[mode=421] [文件或目录]/-R</td>
<td>-R：表示递归修改某一目录下全部文件的权限<br/>改变文件或目录权限<br/>u表示所有者，r=4，w=2，x=1<br/>所在位置/bin/chmod</td>
</tr>
<tr>
<td>chown</td>
<td>[用户] [文件或目录]</td>
<td>改变文件或目录的所有者<br/>所在位置/bin/chown</td>
</tr>
<tr>
<td>chgrp</td>
<td>[用户组] [文件或目录]</td>
<td>改变文件或目录的所属组<br/>所在位置/bin/chgrp</td>
</tr>
<tr>
<td>umask</td>
<td>[-S]</td>
<td>-S：表示以rwx形式显示新建文件缺省权限<br/>显示、设置文件的缺省权限<br/>所在位置Shell内置命令</td>
</tr>
</tbody>
</table>
</div>
<h3 id="2-3-2-示例"><a href="#2-3-2-示例" class="headerlink" title="2.3.2 示例"></a>2.3.2 示例</h3><ul>
<li>chmod u+x,o-r,g=rwx a.list</li>
<li>chmod 640 a.list</li>
<li>chown gaoy a (改变文件a的所有者为gaoy)</li>
<li>chown root:tsgroup /project/（改变project目录的所有者和所属组）</li>
<li>chgrp a b.list</li>
<li>umask -S</li>
</ul>
<h2 id="2-4-文件搜索命令"><a href="#2-4-文件搜索命令" class="headerlink" title="2.4 文件搜索命令"></a>2.4 文件搜索命令</h2><h3 id="2-4-1-命令列表"><a href="#2-4-1-命令列表" class="headerlink" title="2.4.1 命令列表"></a>2.4.1 命令列表</h3><ul>
<li>以下命令执行权限为<strong>所有用户</strong></li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>命令</th>
<th>选项</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>find</td>
<td>[搜索范围] [匹配条件]</td>
<td>-name：根据文件名查找<br/>-iname：不区分大小写查找<br/>- size：根据文件大小查找<br/>-user：根据所有者查找<br/>文件搜索<br/>所在位置/bin/find</td>
</tr>
<tr>
<td>locate</td>
<td>[文件名]</td>
<td>-i：不区分大小写查找<br/>在文件资料库中查找文件，速度比find快<br/>所在位置/usr/bin/locate</td>
</tr>
<tr>
<td>which</td>
<td>[命令名称]</td>
<td>搜索命令所在目录及别名信息<br/>所在位置/usr/bin/which</td>
</tr>
<tr>
<td>whereis</td>
<td>[命令名称]</td>
<td>搜索命令所在目录及帮助文档路径</td>
</tr>
<tr>
<td>grep</td>
<td>-inv [关键字] [文件名]</td>
<td>在文件中搜寻字串匹配的行并输出<br/>所在位置/bin/grep</td>
</tr>
</tbody>
</table>
</div>
<h3 id="2-4-2-示例"><a href="#2-4-2-示例" class="headerlink" title="2.4.2 示例"></a>2.4.2 示例</h3><ul>
<li>find /etc -name init(在目录/etc中查找文件init)</li>
<li>locate inittab</li>
<li>which ls</li>
<li>whereis ls</li>
<li>grep mysql /root/install.log</li>
</ul>
<h2 id="2-5-帮助命令"><a href="#2-5-帮助命令" class="headerlink" title="2.5 帮助命令"></a>2.5 帮助命令</h2><h3 id="2-5-1-命令列表"><a href="#2-5-1-命令列表" class="headerlink" title="2.5.1 命令列表"></a>2.5.1 命令列表</h3><ul>
<li>以下命令执行权限为<strong>所有用户</strong></li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>命令</th>
<th>选项</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>man</td>
<td>[命令或配置文件]</td>
<td>获取帮助信息<br/>按q退出<br/>按空格翻页<br/>按Enter换行<br/>按/-[查找内容]进行查找<br/>按n向下查找<br/>所在位置/usr/bin/man</td>
</tr>
<tr>
<td>whatis</td>
<td>[命令]</td>
<td>简单显示命令帮助信息</td>
</tr>
<tr>
<td>apropos</td>
<td>[配置文件]</td>
<td>查看配置文件的信息</td>
</tr>
<tr>
<td>—help</td>
<td>[命令] —help</td>
<td>查看命令常见选项</td>
</tr>
<tr>
<td>help</td>
<td>[命令]</td>
<td>获取Shell内置命令的版帮助信息<br/>所在位置Shell内置命令</td>
</tr>
</tbody>
</table>
</div>
<h3 id="2-5-2-示例"><a href="#2-5-2-示例" class="headerlink" title="2.5.2 示例"></a>2.5.2 示例</h3><ul>
<li>man ls</li>
<li>man services：查看配置文件services的帮助信息</li>
<li>whatis ls</li>
<li>apropos inittab</li>
<li>ls —help</li>
<li>help umask</li>
</ul>
<h2 id="2-6-用户管理命令"><a href="#2-6-用户管理命令" class="headerlink" title="2.6 用户管理命令"></a>2.6 用户管理命令</h2><h3 id="2-6-1-命令列表"><a href="#2-6-1-命令列表" class="headerlink" title="2.6.1 命令列表"></a>2.6.1 命令列表</h3><ul>
<li>useradd/userdel执行权限为root</li>
<li>其他命令执行权限为所有用户</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>命令</th>
<th>选项</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>useradd</td>
<td>-udcgGs</td>
<td>-u [UID]：手工指定用户的UID<br/>-d [家目录]：手工指定用户的家目录<br/>-c [用户说明]：手工指定用户的说明<br/>-g [组名]：手工指定用户的初始组<br/>-G [组名]：手工指定用户的附加组<br/>-s shell：手工指定用户的登录shell，默认是/bin/bash<br/>所在位置：/usr/sbin/useradd；<br/>添加用户，不推荐手工指定用户的家目录</td>
</tr>
<tr>
<td>passwd</td>
<td>-Slu [用户名]—stdin</td>
<td>-S：查询用户密码的密码状态<br/>-l：暂时锁定用户<br/>-u：解锁用户<br/>—stdin：可以通过管道符输出的数据作为用户的密码<br/>-Slu：这些选项只能由root执行<br/>设置用户密码，root可以更改任何人的密码，普通用户可以更改自己的密码<br/>所在位置：/usr/bin/passwd；<br/>只用root可以改其他用户的密码，其他用户只能直接输入passwd（不用接用户名）改自己的密码（必须符合密码复杂性原则）</td>
</tr>
<tr>
<td>usermod</td>
<td>-ucGLU</td>
<td>-u [UID]：修改用户的UID号<br/>-c [用户说明]：修改用户的说明信息<br/>-G [组名]：修改用户的附加组-L-U；<br/>-L：临时锁定用户<br/>-U：解锁用户锁定</td>
</tr>
<tr>
<td>chage</td>
<td></td>
<td>-l：列出用户的详细密码<br/>-d [日期]：修改密码最后一次更改日期<br/>-m [天数]：两次密码修改间隔<br/>-M [天数]：密码有效期<br/>-W [天数]：密码过期前警告天数<br/>-I [天数]：密码过后宽限天数<br/>-E [日期]：账号失效时间</td>
</tr>
<tr>
<td>userdel</td>
<td>-r [用户名]</td>
<td>-r：删除用户的同时删除用户家目录</td>
</tr>
<tr>
<td>id</td>
<td>[用户名]</td>
<td>查看用户ID（UID、GID等）</td>
</tr>
<tr>
<td>su [选项] [用户名]</td>
<td>-<br/>-c</td>
<td>-：选项只是用“-”代表连带用户的环境变量一起切换<br/>-c：仅执行一次命令，而不切换用户身份</td>
</tr>
<tr>
<td>groupadd</td>
<td>-g [GID] [组名]</td>
<td>-g [GID]：指定组ID</td>
</tr>
<tr>
<td>groupmod [选项] [组名]</td>
<td>-g [GID]-n [新组名]</td>
<td>-g：修改GID<br/>-n：修改组名</td>
</tr>
<tr>
<td>groupdel [组名]</td>
<td></td>
<td>没有初始组，此用户不能存在</td>
</tr>
<tr>
<td>gpasswd</td>
<td>-ad [用户名] [组名]</td>
<td>-a：把用户加入组<br/>-d：把用户从组中删除；<br/>把用户添加入组或从组中删除</td>
</tr>
<tr>
<td>who</td>
<td></td>
<td>查看登录用户信息<br/>所在位置：/usr/bin/who</td>
</tr>
<tr>
<td>w</td>
<td></td>
<td>查看登录用户详细信息<br/>所在位置：/usr/bin/w</td>
</tr>
</tbody>
</table>
</div>
<h3 id="2-6-2-示例"><a href="#2-6-2-示例" class="headerlink" title="2.6.2 示例"></a>2.6.2 示例</h3><ul>
<li>useradd yangmi</li>
<li>echo “123” | passwd —stdin lamp：给用户lamp添加密码123</li>
<li>passwd -l sc：锁定用户（该用户无法登录）</li>
<li>usermod -c “test user” lamp</li>
<li>chage -d 0 lamp：用户一登录就要修改密码</li>
<li>su root：这样切换不会改变此用户的环境变量</li>
<li>su - root：把用户的操作环境也改为root环境（推荐）</li>
<li>su - root -c “useradd user3”：不切换成root，但执行useradd命令添加user3用户</li>
<li>groupmod -n testgrp group1：把组名group1修改为testgrp</li>
<li>gpasswd -a user1 root：把user1用户加入到root组中</li>
<li>who</li>
<li>w</li>
</ul>
<h2 id="2-7-压缩解压命令"><a href="#2-7-压缩解压命令" class="headerlink" title="2.7 压缩解压命令"></a>2.7 压缩解压命令</h2><h3 id="2-7-1-命令列表"><a href="#2-7-1-命令列表" class="headerlink" title="2.7.1 命令列表"></a>2.7.1 命令列表</h3><ul>
<li>以下命令执行权限为<strong>所有用户</strong></li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>命令</th>
<th>选项</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>gzip</td>
<td>[文件]</td>
<td>压缩文件(目录不可以)，压缩后文件格式为.gz，压缩后只保留压缩后的文件，不保留原文件所在位置/bin/gzip</td>
</tr>
<tr>
<td>gunzip</td>
<td>[压缩文件]</td>
<td>解压缩.gz的压缩文件</td>
</tr>
<tr>
<td>tar</td>
<td>-zcfvx [压缩后的文件名] [目录]</td>
<td>-c：打包<br/>-v：显示详细信息<br/>-f：指定文件名<br/>-z：打包同时压缩<br/>-x：解包<br/>打包目录，即把目录打包成一个.tar的文件，压缩后的文件格式为.tar.gz所在位置：/bin/tar</td>
</tr>
<tr>
<td>zip</td>
<td>-r [压缩后文件名] [文件或目录]</td>
<td>-r：压缩目录<br/>压缩文件或目录，压缩后文件格式为.zip<br/>所在位置/usr/bin/zip</td>
</tr>
<tr>
<td>unzip</td>
<td>[压缩文件]</td>
<td>解压.zip的压缩文件<br/>所在位置/usr/bin/unzip</td>
</tr>
<tr>
<td>bzip2</td>
<td>-k [文件]</td>
<td>压缩文件，压缩后文件格式.bz2</td>
</tr>
<tr>
<td>bunzip2</td>
<td>-k [压缩文件]</td>
<td>解压缩</td>
</tr>
</tbody>
</table>
</div>
<h3 id="2-7-2-示例"><a href="#2-7-2-示例" class="headerlink" title="2.7.2 示例"></a>2.7.2 示例</h3><ul>
<li>gunzip a.gz</li>
<li>tar -zcf Japan.tar.gz Japan</li>
<li>tar -axvf Japan.tar.gz（解包）</li>
<li>zip -r Japan.zip Japan</li>
<li>unzip test.zip</li>
<li>bzip2 -k boduo</li>
<li>tar -cjf Japan.tar.bz2 Japan（针对目录）</li>
<li>bunzip2 -k boduo.bz2</li>
<li>tar -xjf Japan.tar.bz2（针对目录）</li>
</ul>
<h2 id="2-8-网络命令"><a href="#2-8-网络命令" class="headerlink" title="2.8 网络命令"></a>2.8 网络命令</h2><h3 id="2-8-1-命令列表"><a href="#2-8-1-命令列表" class="headerlink" title="2.8.1 命令列表"></a>2.8.1 命令列表</h3><ul>
<li>以下命令执行权限为<strong>所有用户</strong></li>
<li>ifconfig执行权限为root，其他均为所有用户</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>命令</th>
<th>选项</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>write</td>
<td>&lt;用户名&gt;</td>
<td>给登录用户发信息<br/>以Ctrl+D保存结束<br/>所在位置：/usr/bin/write</td>
</tr>
<tr>
<td>wall</td>
<td>[message]</td>
<td>发广播信息<br/>所在位置：/usr/bin/wall</td>
</tr>
<tr>
<td>ping</td>
<td>-c [IP地址]</td>
<td>测试网络连通性<br/>所在位置：/bin/ping</td>
</tr>
<tr>
<td>ifconfig</td>
<td>[网卡名称] [IP地址]</td>
<td>查看和设置网卡信息<br/>所在位置：/sbin/ifconfig</td>
</tr>
<tr>
<td>mail</td>
<td>[用户名]</td>
<td>查看发送电子邮件<br/>所在位置/bin/mail</td>
</tr>
<tr>
<td>last</td>
<td></td>
<td>列出目前与过去登入系统的用户信息<br/>所在位置：/usr/bin/last</td>
</tr>
<tr>
<td>lastlog</td>
<td>-u [uid]</td>
<td>检查某特定用户上次登录的时间<br/>所在位置/usr/bin/lastlog</td>
</tr>
<tr>
<td>traceroute</td>
<td></td>
<td>显示数据包到主机间的路径<br/>所在位置：/bin/traceroute</td>
</tr>
<tr>
<td>netstat</td>
<td>-tulrn</td>
<td>显示网络相关信息<br/>所在位置：/bin/netstat</td>
</tr>
<tr>
<td>setup</td>
<td></td>
<td>配置网络<br/>所在位置/usr/bin/setup</td>
</tr>
<tr>
<td>mount</td>
<td>[-t 文件系统] [设备文件名] [挂载点]</td>
</tr>
</tbody>
</table>
</div>
<h3 id="2-8-2-示例"><a href="#2-8-2-示例" class="headerlink" title="2.8.2 示例"></a>2.8.2 示例</h3><ul>
<li>write linzhiling</li>
<li>wall abcdefgh</li>
<li>ping -c 3 192.168.1.156</li>
<li>ifconfig eth0 192.168.8.250</li>
<li>mail root</li>
<li>mail</li>
<li>last</li>
<li>lastlog</li>
<li>lastlog -u 502</li>
<li>traceroute www.baidu.com</li>
<li>netstat -tlun（查看本机监听的端口）</li>
<li>netstat -an（查看本机所有的网络连接）</li>
<li>netstat -rn（查看本机路由表）</li>
<li>setup</li>
<li>mount -t iso9660 /dev/sr0 /mnt/cdrom</li>
<li>umount /dev/sr0（卸载）</li>
</ul>
<h2 id="2-9-关机重启命令"><a href="#2-9-关机重启命令" class="headerlink" title="2.9 关机重启命令"></a>2.9 关机重启命令</h2><h3 id="2-9-1-命令列表"><a href="#2-9-1-命令列表" class="headerlink" title="2.9.1 命令列表"></a>2.9.1 命令列表</h3><div class="table-container">
<table>
<thead>
<tr>
<th>命令</th>
<th>选项</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>shutdown</td>
<td>-chr [时间]</td>
<td>-c：取消前一个关机命令<br/>-h：关机<br/>-r：重启</td>
</tr>
<tr>
<td>reboot</td>
<td></td>
<td>重启</td>
</tr>
<tr>
<td>init 0</td>
<td></td>
<td>关机</td>
</tr>
<tr>
<td>init 6</td>
<td></td>
<td>重启</td>
</tr>
</tbody>
</table>
</div>
<h3 id="2-9-2-系统运行级别"><a href="#2-9-2-系统运行级别" class="headerlink" title="2.9.2 系统运行级别"></a>2.9.2 系统运行级别</h3><h4 id="（1）级别"><a href="#（1）级别" class="headerlink" title="（1）级别"></a>（1）级别</h4><div class="table-container">
<table>
<thead>
<tr>
<th>级别</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>关机</td>
</tr>
<tr>
<td>1</td>
<td>单用户</td>
</tr>
<tr>
<td>2</td>
<td>不完全多用户、不含NFS服务</td>
</tr>
<tr>
<td>3</td>
<td>完全多用户（默认）</td>
</tr>
<tr>
<td>4</td>
<td>未分配</td>
</tr>
<tr>
<td>5</td>
<td>图形界面</td>
</tr>
<tr>
<td></td>
<td>重启</td>
</tr>
</tbody>
</table>
</div>
<h4 id="（2）相关命令"><a href="#（2）相关命令" class="headerlink" title="（2）相关命令"></a>（2）相关命令</h4><div class="table-container">
<table>
<thead>
<tr>
<th>命令</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>runlevel</td>
<td>查看系统运行级别</td>
</tr>
<tr>
<td>logout</td>
<td>退出登录</td>
</tr>
</tbody>
</table>
</div>
<h2 id="2-10-Shell命令"><a href="#2-10-Shell命令" class="headerlink" title="2.10 Shell命令"></a>2.10 Shell命令</h2><h3 id="2-10-1-命令列表"><a href="#2-10-1-命令列表" class="headerlink" title="2.10.1 命令列表"></a>2.10.1 命令列表</h3><div class="table-container">
<table>
<thead>
<tr>
<th>命令</th>
<th>选项</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>echo</td>
<td>-e [输出内容]</td>
<td>-e：支持反斜线控制的字符转换；基本输出命令</td>
</tr>
<tr>
<td>history</td>
<td>-cw [历史命令保存文件]</td>
<td>-c：清空历史命令（不推荐清空）<br/>-w：把缓存中的历史命令写入历史命令保护文件<br/>~/.bash_history<br/>查看之前输入的命令，不加w选项，刚输入的命令还在缓存中，还未写入历史命令保存文件中，默认保存1000条历史命令（可以在环境变量配置文件/etc/profile中进行修改）</td>
</tr>
<tr>
<td>alias</td>
<td>[别名]=[‘原命令’]</td>
<td>alias [别名]=[‘原命令’]：设定命令别名<br/>alias：查询命令别名<br/>临时生效，重启后无效</td>
</tr>
</tbody>
</table>
</div>
<h3 id="2-10-2-示例"><a href="#2-10-2-示例" class="headerlink" title="2.10.2 示例"></a>2.10.2 示例</h3><ul>
<li>history</li>
<li>history -w</li>
<li>alias vi=’vim’</li>
<li>alias</li>
</ul>
<h2 id="2-11-字符提取命令"><a href="#2-11-字符提取命令" class="headerlink" title="2.11 字符提取命令"></a>2.11 字符提取命令</h2><h3 id="2-11-1-cut命令"><a href="#2-11-1-cut命令" class="headerlink" title="2.11.1 cut命令"></a>2.11.1 cut命令</h3><ul>
<li>选项：-df [文件名]</li>
<li>解释：<ul>
<li>-d 分隔符：按照指定分隔符分割列</li>
<li>-f 列号：提取第几列</li>
</ul>
</li>
<li>说明：默认提取以制表符分割的列</li>
</ul>
<h3 id="2-11-2-printf命令"><a href="#2-11-2-printf命令" class="headerlink" title="2.11.2 printf命令"></a>2.11.2 printf命令</h3><ul>
<li>‘输出类型/输出格式’ 输出内容</li>
<li>输出类型：<ul>
<li>%ns：输出字符串。n是数字指代输出几个字符</li>
<li>%ni：输出整数。n是数字指代输出几个数字</li>
<li>%m.nf：输出浮点数。m和n是数字，指代输出的整数位数和小数位数。如%8.2f代表共输出8位数，其中2位是小数，6位是整数</li>
</ul>
</li>
<li><p>输出格式：</p>
<ul>
<li>\a：输出警告音</li>
<li>\b：输出退格键</li>
<li>\f：清除屏幕</li>
<li>\n：换行</li>
<li>\r：回车</li>
<li>\t：水平输出退格键，即Tab键</li>
<li>\v：垂直输出退格键，即Tab键</li>
</ul>
</li>
<li><p>说明：利用管道符或者直接接文件名都无法利用此命令输出文件内容，print和printf一般在awk命令中使用</p>
</li>
<li>示例<ul>
<li>printf ‘%s %s %s \n’ 1 2 3 4 5 6</li>
<li>printf ‘%s’ $(cat s.txt)：输出文件内容</li>
</ul>
</li>
</ul>
<h3 id="2-11-3-awk命令"><a href="#2-11-3-awk命令" class="headerlink" title="2.11.3 awk命令"></a>2.11.3 awk命令</h3><ul>
<li>选项：<ul>
<li>‘条件1 {动作1}</li>
<li>条件2 {动作2}…’ 文件名</li>
</ul>
</li>
<li>条件：<ul>
<li>一般使用关系表达式作为条件</li>
<li>x&gt;10</li>
<li>x&gt;=10</li>
<li>x&lt;=10</li>
</ul>
</li>
<li>动作：格式化输出流程控制语句</li>
<li>说明：print只能在awk中使用，会自动换行</li>
<li>示例：<ul>
<li>awk ‘{printf $2 “\t” $6 “\n”}’ s.txt：输出文件第2列和第六列</li>
<li>df -h | awk ‘{print $1 “\t” $3}’</li>
<li>df -h | grep sda5 | awk ‘{print $5}’ | cut -d “%” -f 1：截取某一行的第5列数据</li>
<li>awk ‘BEGIN{printf “This is a txt \n”} {print $2 “\t” $5}’ s.txt：在输出文件内容前，先输出This is a txt</li>
<li>awk ‘BEGIN{FS=”:”} {print $1 “\t” $3}’ /etc/passwd：FS指定分隔符为冒号，不加BEGIN，文件的第一行就不会处理</li>
<li>awk ‘END{printf “The End \n”} {printf $2 “\t” $6 “\n”}’ s.txtEND：表示输出完成之后，再输出The End</li>
</ul>
</li>
</ul>
<h3 id="2-11-4-sed命令"><a href="#2-11-4-sed命令" class="headerlink" title="2.11.4 sed命令"></a>2.11.4 sed命令</h3><ul>
<li>选项：[-nei] ‘[动作]’ [文件名]</li>
<li>解释：<ul>
<li>-n：一般sed命令会把所有数据都输出到屏幕，如果加入此选项，则只会把经过sed命令处理的行输出到屏幕</li>
<li>-e：允许对输入数据应用多条sed命令编辑</li>
<li>-i：用sed的修改结果直接修改读取数据的文件，而不是由屏幕输出</li>
</ul>
</li>
<li><p>动作：</p>
<ul>
<li>a \：追加，在当前行后添加一行或多行。添加多行时，除最后一行外，每行末尾需要用“\”代表数据未完结</li>
<li>c \：行替换，用c后面的字符串替换原数据行，替换多行时，除最后一行外，每行末尾需用“\”代表数据未完结</li>
<li>i \：插入，在当前行前插入一行或多行。插入多行时，除最后一行外，每行末尾需要用“\”代表数据未完结</li>
<li>d：删除，删除指定的行</li>
<li>p：打印，输出指定的行</li>
<li>s：字串替换，用一个字符串替换另外一个字符串。</li>
<li>格式为“行范围s/旧字串/新字串/g”（和vim中的替换格式类似）</li>
</ul>
</li>
<li><p>示例：</p>
<ul>
<li>sed -n ‘2p’ s.txt：输出第二行，不加-n会把所有内容都输出</li>
<li>df -h | sed -n ‘2p’ s.txt：输出df命令内容第2行</li>
<li>sed ‘2,4d’ s.txt：将文件输出的内容的第2到4行删除，但不改变文件本身</li>
<li>sed ‘2i hello \world’ s.txt：在文件输出内容第2行插入hello world内容，并不改变文件本身</li>
<li>sed ‘4s/99/55/g’ s.txt：将文件输出内容的第4行的99改为55</li>
<li>sed -e ‘s/LiMing//g ; s/Gao//g/‘ s.txt：同时把LiMing和Gao修改为空白</li>
</ul>
</li>
</ul>
<h1 id="三、网络配置"><a href="#三、网络配置" class="headerlink" title="三、网络配置"></a>三、网络配置</h1><h2 id="3-1-准备工作"><a href="#3-1-准备工作" class="headerlink" title="3.1 准备工作"></a>3.1 准备工作</h2><ul>
<li>将虚拟机网络配置改为桥接模式，才能保证主机和虚拟机ping通</li>
</ul>
<h2 id="3-2-第一步"><a href="#3-2-第一步" class="headerlink" title="3.2 第一步"></a>3.2 第一步</h2><h3 id="3-2-1-修改配置文件参数"><a href="#3-2-1-修改配置文件参数" class="headerlink" title="3.2.1 修改配置文件参数"></a>3.2.1 修改配置文件参数</h3><ol>
<li>dhclient：动态分配IP地址</li>
<li>vim /etc/sysconfig/network-scripts/ifcfg-ens33</li>
<li>修改静态IP：BOOTPROTO=static</li>
<li>修改自启动：ONBOOT=yes</li>
</ol>
<h2 id="3-3-第二步"><a href="#3-3-第二步" class="headerlink" title="3.3 第二步"></a>3.3 第二步</h2><h3 id="3-3-1-向配置文件添加IP地址、子网掩码、网关、DNS"><a href="#3-3-1-向配置文件添加IP地址、子网掩码、网关、DNS" class="headerlink" title="3.3.1 向配置文件添加IP地址、子网掩码、网关、DNS"></a>3.3.1 向配置文件添加IP地址、子网掩码、网关、DNS</h3><ul>
<li>IPADDR=192.168.1.102</li>
<li>NETMASK=255.255.255.0</li>
<li>GATEWAY=192.168.1.1</li>
<li>DNS1=119.29.29.29</li>
<li>GATEWAY和IPADDR需要在同一网段下，否则无法上网</li>
</ul>
<h2 id="3-4-第三步"><a href="#3-4-第三步" class="headerlink" title="3.4 第三步"></a>3.4 第三步</h2><ul>
<li>重启网络服务：systemctl restart network.service</li>
</ul>
<h1 id="四、开启web服务"><a href="#四、开启web服务" class="headerlink" title="四、开启web服务"></a>四、开启web服务</h1><h2 id="4-1-安装tomcat"><a href="#4-1-安装tomcat" class="headerlink" title="4.1 安装tomcat"></a>4.1 安装tomcat</h2><h2 id="4-2-安装nginx"><a href="#4-2-安装nginx" class="headerlink" title="4.2 安装nginx"></a>4.2 安装nginx</h2><h2 id="4-3-开放端口"><a href="#4-3-开放端口" class="headerlink" title="4.3 开放端口"></a>4.3 开放端口</h2><ul>
<li>在不关闭防火墙的前提下，开放浏览器访问端口<ul>
<li>开启tomcat：systemctl start tomcat.service</li>
<li>永久开放8080端口：firewall-cmd —zone=public —add-port=8080/tcp —permanent</li>
<li>重启防火墙：systemctl restart firewalld.service</li>
<li>查看是否开放成功：firewall-cmd —list-ports</li>
</ul>
</li>
<li>也可以关闭防火墙对服务器进行访问：<ul>
<li>暂时关闭防火墙：systemctl stop firewalld</li>
<li>永久关闭防火墙：systemctl disable firewalld</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://cnovelist.github.io/2022/03/27/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%9F%BA%E7%A1%80%E5%A4%A7%E5%85%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/yue.jpeg">
      <meta itemprop="name" content="故事开头">
      <meta itemprop="description" content="一个穷鬼">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="江小月不上頭">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/03/27/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%9F%BA%E7%A1%80%E5%A4%A7%E5%85%A8/" class="post-title-link" itemprop="url">设计模式基础大全</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-03-27 21:37:18 / 修改时间：22:01:55" itemprop="dateCreated datePublished" datetime="2022-03-27T21:37:18+08:00">2022-03-27</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%90%8E%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">后端</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%90%8E%E7%AB%AF/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="一、设计模式基础"><a href="#一、设计模式基础" class="headerlink" title="一、设计模式基础"></a>一、设计模式基础</h1><h2 id="1-1-GoF的23种设计模式及其功能"><a href="#1-1-GoF的23种设计模式及其功能" class="headerlink" title="1.1 GoF的23种设计模式及其功能"></a>1.1 GoF的23种设计模式及其功能</h2><ol>
<li>单例（ Singleton ）模式 某个类只能生成一个实例，该类提供了一个全局访问点供外部获取该实例，其拓展是有限多例模式。</li>
<li>原型（Prototype）模式：将一个对象作为原型，通过对其进行复制而克隆出多个和原型类似的新实例</li>
<li>工厂方法（Factory Method）模式：定义一个用于创建产品的接口，由子类决定生存什么产品</li>
<li>抽象工厂（Abstract Factory）模式：提供一个创建产品族的接口，其每个子类可以生产一系列相关的产品</li>
<li>建造者（Builder）模式：将一个复杂对象分解成多个相对简单的部分，然后根据不同需要分别创建它们</li>
<li>代理（Proxy）模式：为某对象提供一种代理以控制对该对象的访问。即客户端通过代理间接地访问该对象，从而限制、增强或修改该对象的一些特性</li>
<li>适配器（Adapter）模式：将一个类的接口转换成客户希望的另外一个接口，使得原本由于接口不兼容而不能在一起工作的那些类能一起工作</li>
<li>桥街（Bridge）模式：将抽象与实现分离，使它们可以独立变化，它是用组合关系代替继承关系来实现，从而降低了抽象和实现这两个可变维度的耦合度。</li>
<li>装饰（Decorator）模式：：动态的给对象增加一些职责，即增加其额外的功能</li>
<li>外观（ Facade ）模式：为多个复杂的子系统提供一个一致的接口，使这些子系统更加容易被访问</li>
<li>享元（Flyweight）模式：运用共享技术来有效地支持大量细粒度对象的复用</li>
<li>组合（ Composite ）模式：将对象组合成树状层次结构，使用户对单个对象和组合对象具有一致的访问性</li>
<li>模板方法（ Templat Method ）模式：定义一个操作中的算法骨架 ，而将算法的一些步骤延迟到子类中，使得子类可以不改变该算法结构的情况下重定义该算法的某些特定步骤</li>
<li>策略（ Strategy ）模式：定义了一系列算法，并将每个算法封装起来，使它们可以相互替换，且算法的改变不会影响使用算法的客户</li>
<li>命令（ Command ）模式：将一个请求封装为一个对象 ，使发出请求的责任和执行请求的责任分割开</li>
<li>职责链 （Chain of Responsibility ）模式：把请求从链中的一个对象传到下一个对象 ，直到请求被响应为止。通过这种方式去除对象之间的耦合</li>
<li>状态（ State ）模式：允许一个对象在其内部状态发生改变时改变其行为能力</li>
<li>观察者（ Observer 模式：多个对象间存在－对多关系，当一个对象发生改变时，把这种改变通知给其他多个对象，从而影响其他对象的行为</li>
<li>中介者（ Mediator ）模式：定义一个中介对象来简化原有对象之间的交互关系，降低系统中对象间的耦合度，使原有对象之间不必相互了解</li>
<li>迭代器 Iterator ）模式 提供一种方法来顺序访问聚合对象中的一系列数据 ，而不暴露聚合对象的内部表示</li>
<li>访问者（Visitor）模式：在不改变集合元素的前提下，为一个集合种的每个元素提供多种访问方式，即每个元素有多个访问者对象访问</li>
<li>备忘录（Memento）模式：在不破坏封装性的前提下，获取并保存一个对象的内部状态以便以后恢复它</li>
<li>解释器（Interpreter）模式：提供如何定义语言的文法，以及对语言句子的解释方法，即解释器</li>
</ol>
<h1 id="二、面向对象的设计原则"><a href="#二、面向对象的设计原则" class="headerlink" title="二、面向对象的设计原则"></a>二、面向对象的设计原则</h1><h2 id="2-1-开闭原则OCP"><a href="#2-1-开闭原则OCP" class="headerlink" title="2.1 开闭原则OCP"></a>2.1 开闭原则OCP</h2><ul>
<li>对扩展开放、对修改关闭</li>
<li>通过“抽象约束、封装变化”来实现开闭原则</li>
<li>抽象层设计的合理，可以基本保持软件架构的稳定</li>
<li>当软件需求发生变化时，只需要根据需求派生一个实现类来扩展就可以了</li>
</ul>
<h2 id="2-2-里氏替换原则LSP"><a href="#2-2-里氏替换原则LSP" class="headerlink" title="2.2 里氏替换原则LSP"></a>2.2 里氏替换原则LSP</h2><ul>
<li>子类可以扩展父类的功能，但不能改变父类原有的功能</li>
<li>简单来说：子类继承父类时，除添加新的方法完成新增功能外，尽量不要重写父类的方法</li>
<li>作用：实现开闭原则的重要方式之一、提高父类可复用性、降低类的扩展出错的可能性</li>
<li>如果出现因重写父类方法而导致出错的情况，应该设计个更一般的类，重新组织类的继承关系</li>
</ul>
<h2 id="2-3-依赖倒置原则DIP"><a href="#2-3-依赖倒置原则DIP" class="headerlink" title="2.3 依赖倒置原则DIP"></a>2.3 依赖倒置原则DIP</h2><ul>
<li>要面向接口编程，不要面向实现编程</li>
<li>抽象层相对稳定，实现类较为多变</li>
<li>接口/抽象类的目的是制定好规范和契约，不去涉及任何具体的操作</li>
<li>具体细节的任务交给实现类完成</li>
<li>作用：降低了类间的耦合性、提高系统的稳定性、提高代码可读性和可维护性</li>
</ul>
<h3 id="2-3-1-实现方法"><a href="#2-3-1-实现方法" class="headerlink" title="2.3.1 实现方法"></a>2.3.1 实现方法</h3><ol>
<li>每个类尽量提供接口或抽象类，或者两者都具备</li>
<li>变量的声明类型尽量是接口或者是抽象类</li>
<li>任何类都不应该从具体类派生</li>
<li>使用继承时尽量遵循里氏替换原则</li>
</ol>
<h2 id="2-4-单一职责原则SRP"><a href="#2-4-单一职责原则SRP" class="headerlink" title="2.4 单一职责原则SRP"></a>2.4 单一职责原则SRP</h2><ul>
<li>一个类应该有且仅有一个引起它变化的原因，否则应该被拆分</li>
<li>承担太多职责的缺点：削弱类实现其他职责的能力、冗余代码</li>
<li>作用：降低类的复杂度、提高类的可读性、提高系统可维护性、变更引起的风险降低</li>
<li>实现方法：分析、设计、重构</li>
<li>同样适用于方法，方法应尽可能做好一件事情</li>
</ul>
<h2 id="2-5-接口隔离原则ISP"><a href="#2-5-接口隔离原则ISP" class="headerlink" title="2.5 接口隔离原则ISP"></a>2.5 接口隔离原则ISP</h2><ul>
<li>程序员尽量将臃肿庞大的接口拆分成更小的和更具体的接口，让接口中只包含客户感兴趣的方法</li>
<li>要为类建立它们需要的专用接口，而不要视图去建立一个很庞大的接口供所有依赖它的类去调用</li>
<li>作用：提高系统灵活性和可维护性、降低系统耦合性、提高系统内聚性、接口粒度大小要定义合理（太大太小都不好）、减少代码冗余、能够体现对象的层次<br>实现方法：一个接口只服务于一个子模块或业务逻辑、为依赖接口的类定制服务、深入了解环境/业务逻辑、使接口用最少的方法实现最多的事情</li>
</ul>
<h2 id="2-6-迪米特法则LKP"><a href="#2-6-迪米特法则LKP" class="headerlink" title="2.6 迪米特法则LKP"></a>2.6 迪米特法则LKP</h2><ul>
<li>如果两个软件实体无须直接通信，那么就不应当发生直接的相互调用，可以通过第三方转发该调用</li>
<li>作用：降低类间耦合度、提高模块相对独立性、提高类的可复用性和系统的扩展性</li>
<li>过渡使用LKP会使系统产生大量的中介类，从而增加系统的复杂性，所以使用时要权衡好</li>
<li>实现方法：依赖者应该依赖应该依赖的对象、被依赖者只暴露应该暴露的方法</li>
<li>注意：应创建弱耦合的类、降低类成员的访问权限、优先考虑设计不变类、降低引用次数、不暴露属性成员（提供get和set）、进行使用序列化</li>
</ul>
<h2 id="2-7-合成复用原则CRP"><a href="#2-7-合成复用原则CRP" class="headerlink" title="2.7 合成复用原则CRP"></a>2.7 合成复用原则CRP</h2><ul>
<li>又称组合/聚合复用原则（CARP）</li>
<li>它要求在软件复用时，要尽量先使用组合或者聚合等关联关系来实现，其次才考虑使用继承关系来实现</li>
<li>如果要使用继承关系，则必须严格遵循里氏代换原则</li>
<li>合成复用原则和里氏代换原则都是开闭原则的具体实现规范</li>
<li>类的复用包括：继承复用、合成复用</li>
</ul>
<h3 id="2-7-1-继承复用"><a href="#2-7-1-继承复用" class="headerlink" title="2.7.1 继承复用"></a>2.7.1 继承复用</h3><ul>
<li>破坏了类的封装性，父类暴露给子类</li>
<li>子类与父类耦合度高</li>
<li>限制了复用的灵活性，父类继承而来的实现是静态的，在编译时已经定义、所以在运行时不可能发生变化</li>
</ul>
<h3 id="2-7-2-合成复用"><a href="#2-7-2-合成复用" class="headerlink" title="2.7.2 合成复用"></a>2.7.2 合成复用</h3><ul>
<li>维持了类的封装性</li>
<li>新旧类之间的耦合度低</li>
<li>复用的灵活性高，可以在运行时动态进行，新对象可以动态地引用与成分对象类型相同的对象</li>
</ul>
<h1 id="三、创建型模式"><a href="#三、创建型模式" class="headerlink" title="三、创建型模式"></a>三、创建型模式</h1><h2 id="3-1-特点"><a href="#3-1-特点" class="headerlink" title="3.1 特点"></a>3.1 特点</h2><ul>
<li>创建型模式的主要关注点是“怎样创建对象”</li>
<li>将对象的创建与使用分离，这样可以降低系统耦合度，使用者不需要关注对象的创建细节</li>
<li>对象的创建由工厂来完成</li>
</ul>
<h2 id="3-2-模式"><a href="#3-2-模式" class="headerlink" title="3.2 模式"></a>3.2 模式</h2><ul>
<li>单例模式Singleton</li>
<li>原型模式Prototype</li>
<li>工厂模式Factory Method</li>
<li>抽象工厂模式Abstract Factory</li>
<li>建造者模式Builder</li>
</ul>
<h1 id="四、单例模式"><a href="#四、单例模式" class="headerlink" title="四、单例模式"></a>四、单例模式</h1><h2 id="4-1-定义"><a href="#4-1-定义" class="headerlink" title="4.1 定义"></a>4.1 定义</h2><ul>
<li>一个类只有一个实例，且该类能自行创建这个实例的一种模式</li>
<li>比如windows的任务管理器、回收站、应用程序的日志对象、网站的计数器等等，一般都设计为单例</li>
</ul>
<h2 id="4-2-特点"><a href="#4-2-特点" class="headerlink" title="4.2 特点"></a>4.2 特点</h2><ul>
<li>单例类只有一个实例对象</li>
<li>该单例对象必须由单例类自行创建</li>
<li>单例类对外提供一个访问该单例的全局访问点</li>
</ul>
<h2 id="4-3-结构"><a href="#4-3-结构" class="headerlink" title="4.3 结构"></a>4.3 结构</h2><ul>
<li>单例类：包含一个实例且能自行创建这个实例的类</li>
<li>访问类：使用单例的类</li>
</ul>
<h2 id="4-4-实现"><a href="#4-4-实现" class="headerlink" title="4.4 实现"></a>4.4 实现</h2><h3 id="4-4-1-懒汉式"><a href="#4-4-1-懒汉式" class="headerlink" title="4.4.1 懒汉式"></a>4.4.1 懒汉式</h3><ul>
<li>特点：类加载时没有生成实例，只有第一次调用getInstance方法时才去创建这个单例</li>
<li>编写多线程程序时，关键字volatile和synchronized不能删除，否则存在线程不安全的问题，但缺点是影响性能，会消耗更多的资源</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LazySingleton</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> LazySingleton instance=<span class="keyword">null</span>;  <span class="comment">//保证instance在所有线程中同步</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">LazySingleton</span><span class="params">()</span></span>&#123;&#125;   <span class="comment">// private避免类在外部被实例化</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> LazySingleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;  <span class="comment">//getInstance方法前加同步</span></span><br><span class="line">        <span class="keyword">if</span>(instance==<span class="keyword">null</span>)</span><br><span class="line">            instance=<span class="keyword">new</span> LazySingleton();</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-4-2-饿汉式"><a href="#4-4-2-饿汉式" class="headerlink" title="4.4.2 饿汉式"></a>4.4.2 饿汉式</h3><ul>
<li>特点：类一旦加载就创建一个单例，保证在调用getInstance方法之前单例就已经存在了</li>
<li>饿汉式由于其特点，所以是线程安全的，可以直接用于多线程而不会出现问题</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HungrySingleton</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> HungrySingleton instance=<span class="keyword">new</span> HungrySingleton();</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">HungrySingleton</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> HungrySingleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="4-5-应用场景"><a href="#4-5-应用场景" class="headerlink" title="4.5 应用场景"></a>4.5 应用场景</h2><ul>
<li>某类只要求生成一个对象的时候</li>
<li>当对象需要被共享的场合</li>
<li>当某类需要频繁实例化，而创建的对象又频繁被消耗的时候</li>
</ul>
<h1 id="五、原型模式"><a href="#五、原型模式" class="headerlink" title="五、原型模式"></a>五、原型模式</h1><h2 id="5-1-定义"><a href="#5-1-定义" class="headerlink" title="5.1 定义"></a>5.1 定义</h2><ul>
<li>通过传统的构造函数来创建对象，会比较复杂且耗时耗资源</li>
<li>用一个已经创建的实例作为原型，通过复制该原型对象来创建一个和原型相同或相似的新对象</li>
<li>如：系统的复制</li>
</ul>
<h2 id="5-2-结构"><a href="#5-2-结构" class="headerlink" title="5.2 结构"></a>5.2 结构</h2><ul>
<li>抽象原型类：规定了具体原型对象必须实现的接口</li>
<li>具体原型类：实现抽象原型类的clone()方法，它是可被复制的对象</li>
<li>访问类：使用具体原型类中的clone()方法来复制新的对象</li>
</ul>
<h2 id="5-3-实现"><a href="#5-3-实现" class="headerlink" title="5.3 实现"></a>5.3 实现</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//具体原型类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Realizetype</span> <span class="keyword">implements</span> <span class="title">Cloneable</span></span>&#123;</span><br><span class="line">    Realizetype()&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;具体原型创建成功&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;具体原型复制成功&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> (Realizetype) <span class="keyword">super</span>.clone();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//原型模式的测试类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PrototypeTest</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> CloneNotSupportedException</span>&#123;</span><br><span class="line">        Realizetype obj1=<span class="keyword">new</span> Realizetype();</span><br><span class="line">        Realizetype obj2=(Realizetype) obj1.clone();</span><br><span class="line">        System.out.println(<span class="string">&quot;obj1==obj2?&quot;</span>+(obj1==obj2));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    运行结果：</span></span><br><span class="line"><span class="comment">    具体原型复制成功</span></span><br><span class="line"><span class="comment">    具体原型复制成功</span></span><br><span class="line"><span class="comment">    obj1==obj2?false</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<h2 id="5-4-应用场景"><a href="#5-4-应用场景" class="headerlink" title="5.4 应用场景"></a>5.4 应用场景</h2><ul>
<li>对象之间相同或相似，即只是个别的几个属性不同的时候</li>
<li>对象的创建过程比较麻烦，但复制比较简单的时候</li>
</ul>
<h1 id="六、工厂方法模式"><a href="#六、工厂方法模式" class="headerlink" title="六、工厂方法模式"></a>六、工厂方法模式</h1><h2 id="6-1-定义"><a href="#6-1-定义" class="headerlink" title="6.1 定义"></a>6.1 定义</h2><ul>
<li>定义：定义一个创建产品对象 工厂接口，将产品对象的实际创建工作推迟到具体子工厂类当中</li>
<li>简单工厂模式：如果要创建的产品不多，只要一个工厂类就可以完成，这种模式叫“简单工厂模式”， 它不属于 GoF 23 经典设计模式，它的缺点是增加新产品时会违背“开闭原则”</li>
</ul>
<h2 id="6-2-特点"><a href="#6-2-特点" class="headerlink" title="6.2 特点"></a>6.2 特点</h2><ul>
<li>满足创建型模式中所要求的“创建与使用相分离”的特点。我们把被创建的对象称为“产品”，把创建产品的对象称为“工厂”</li>
<li>用户只需要知道具体工厂的名称就可得到所要的产品，无须知道产品的具体创建过程</li>
<li>在系统增加新的产品时只需要添加具体产品类和对应的具体工厂类，无须对原工厂进行任何修改 ，满足开闭原则。</li>
<li>缺点 每增加一个产品就要增加一个具体产品类和一个对应的具体工厂类 ，这增加了系统的复杂度</li>
</ul>
<h2 id="6-3-结构"><a href="#6-3-结构" class="headerlink" title="6.3 结构"></a>6.3 结构</h2><ul>
<li>抽象工厂（Abstract Factory）：提供了创建产品的接口 ，调用者通过它访问具体工厂的工厂方法 newProduct（）来创建产品。</li>
<li>具体工厂（Concrete Factory）：主要是实现抽象工厂中的抽象方法 完成具体产品的创建。</li>
<li>抽象产品（Product）：定义了产品的规范 描述了产品的主要特性和功能。</li>
<li>具体产品（Concrete Product）：：实现了抽象产品角色所定义的接口，由具体工厂来创建，它同具体工厂之间一一对应。</li>
</ul>
<h2 id="6-4-实现"><a href="#6-4-实现" class="headerlink" title="6.4 实现"></a>6.4 实现</h2><h3 id="6-4-1-xml配置"><a href="#6-4-1-xml配置" class="headerlink" title="6.4.1 xml配置"></a>6.4.1 xml配置</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">className</span>&gt;</span>ConcreteFactory1<span class="tag">&lt;/<span class="name">className</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">config</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="6-4-2-对象生成器"><a href="#6-4-2-对象生成器" class="headerlink" title="6.4.2 对象生成器"></a>6.4.2 对象生成器</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> FactoryMethod;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractFactoryTest</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(string args[])</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            Product a;</span><br><span class="line">            AbstractFactory af;</span><br><span class="line">            af=(AbstractFactory) ReadXML1.getObject();</span><br><span class="line">            a=af.newProduct();</span><br><span class="line">            a.show();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            System.out.println(e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//抽象产品，提供了产品的接口</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Product</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//具体产品1：实现抽象产品中的抽象方法</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConcreteProduct1</span> <span class="keyword">implements</span> <span class="title">Product</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;具体产品1显示...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//具体产品2：实现抽象产品中的抽象方法</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConcreteProduct2</span> <span class="keyword">implements</span> <span class="title">Product</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;具体产品2显示...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//抽象工厂1：提供了产品的生成方法</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">AbstractFactory</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">newProduct</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//具体工厂1：实现了产品的生成方法</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConcreteFactory</span> <span class="keyword">implements</span> <span class="title">AbstractFactory</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">newProduct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;具体工厂1生成-&gt;具体产品1&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ConcreteFactory();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//具体工厂2：实现了产品的生成方法</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConcreteFactory2</span> <span class="keyword">implements</span> <span class="title">AbstractFactory</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">newProduct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;具体工厂2生成-&gt;具体产品2&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ConcreteFactory2();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-5-应用场景"><a href="#6-5-应用场景" class="headerlink" title="6.5 应用场景"></a>6.5 应用场景</h2><ol>
<li>客户只知道创建产品的工厂名，而不知道具体的产品名。如TCL电视工厂、海信电视工厂等。</li>
<li>创建对象的任务由多个具体子工厂中的某一个完成，而抽象工厂只提供创建产品的接口</li>
<li>客户不关心创建产品的细节，只关心产品的品牌</li>
</ol>
<h1 id="七、抽象工厂模式"><a href="#七、抽象工厂模式" class="headerlink" title="七、抽象工厂模式"></a>七、抽象工厂模式</h1><h2 id="7-1-定义"><a href="#7-1-定义" class="headerlink" title="7.1 定义"></a>7.1 定义</h2><ul>
<li>抽象工厂模式将考虑多等级产品的生产 将同一个具体工厂所生产的位于不同等级的一组产品称为一个产品族</li>
<li>同等级：同种类称为同等级，也就是说 工厂方法模式只考虑生产同等级的产品</li>
<li>抽象工厂（Abstract Factory）模式：是一种为访问类提供一个创建一组相关或相互依赖对<br>象的接口，且访问类无须指定所要产品的具体类就能得到同族的不同等级的产品的模式结构</li>
</ul>
<h2 id="7-2-特点"><a href="#7-2-特点" class="headerlink" title="7.2 特点"></a>7.2 特点</h2><ul>
<li>前面介绍的工厂方法模式中考虑的是一类产品的生产，如畜牧场只养动物、电视机厂只生产电视机、计算机软件学院只培养计算机软件专业的学生等</li>
<li>在现实生活中许多工厂是综合型的工厂能生产多等级（种类）的产品，如农场里既养动物又种植物，电器厂既生产电视机又生产洗衣机或空调，大学既有软件专业又有生物专业等</li>
<li>工厂方法模式只生产一个等级的产品，而抽象工厂模式可生<br>产多个等级的产品。</li>
</ul>
<h2 id="7-3-条件"><a href="#7-3-条件" class="headerlink" title="7.3 条件"></a>7.3 条件</h2><ol>
<li>系统中有多个产品族，每个具体工厂 建同一族但属于不同等级结构的产品。</li>
<li>系统一次只可能消费其中某一族产品，即同族的产品一起使用。</li>
</ol>
<h2 id="7-4-优缺点"><a href="#7-4-优缺点" class="headerlink" title="7.4 优缺点"></a>7.4 优缺点</h2><ul>
<li>优点：<ul>
<li>可以在类的内部对产品族中相关联的多等级产品共同管理，而不必专门引入多个新的类来进<br>行管理。</li>
<li>当增加一个新的产品族时不需要修改原代码， 满足开闭原则。</li>
</ul>
</li>
<li>缺点：<ul>
<li>当产品族 需要增加一个新的产品时，所有的工厂类都需要进行修改。</li>
</ul>
</li>
</ul>
<h2 id="7-5-结构"><a href="#7-5-结构" class="headerlink" title="7.5 结构"></a>7.5 结构</h2><ul>
<li>抽象工厂Abstract Factory：提供了创建产品的接口，它包含多个创建产品的方法<br>new Product（）， 以创建多个不同等级 产品。</li>
<li>具体工厂Concrete Factory：主要是实现抽象工厂中的多个抽象方法，完成具体产品的创建</li>
<li>抽象产品Product：：定义了产品的规范，描述了产品的主要特性和功能，抽象工厂模式有多个抽象产品。</li>
<li>具体产品Concrete Product：）：实现了抽象产品角色所定义的接口，由具体工厂来创建，它同具体工厂之间是多对一的关系。</li>
</ul>
<h2 id="7-6-实现"><a href="#7-6-实现" class="headerlink" title="7.6 实现"></a>7.6 实现</h2><h3 id="7-6-1-抽象工厂"><a href="#7-6-1-抽象工厂" class="headerlink" title="7.6.1 抽象工厂"></a>7.6.1 抽象工厂</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">AbstractFactory</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product1 <span class="title">newProduct1</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product2 <span class="title">newProduct2</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="7-6-2-具体工厂"><a href="#7-6-2-具体工厂" class="headerlink" title="7.6.2 具体工厂"></a>7.6.2 具体工厂</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConcreteFactory1</span> <span class="keyword">implements</span> <span class="title">AbstractFactory</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product1 <span class="title">newProduct1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;具体工厂1生成-&gt;具体产品11...&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ConcreteProduct11();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product2 <span class="title">newProduct2</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;具体工厂1生成-&gt;具体产品21...&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ConcreteProduct21();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="7-7-应用场景"><a href="#7-7-应用场景" class="headerlink" title="7.7 应用场景"></a>7.7 应用场景</h2><ol>
<li>当需要创建的对象是一系列相互关联或相互依赖的产品族时，如电器 厂中的电视机衣机、空调等。</li>
<li>系统中有多个产品族 但每次只使用其中的某一族产品。如有人只喜欢穿某一个品牌的衣<br>服和鞋</li>
<li>系统中提供了产品的类库，且所有产品的接口相同，客户端不依赖产品实例的创建细节和内部结构</li>
</ol>
<h2 id="7-8-小结"><a href="#7-8-小结" class="headerlink" title="7.8 小结"></a>7.8 小结</h2><ol>
<li>当增加一 新的产品族 只需增 一个<br>新的具体工厂，不需要修改原代码，满足开闭原则</li>
<li>当产品族中需要增加一 新种类的产品时，则所有的工厂类都需要进行修改，不满足开闭原则</li>
<li>当系统中只存在 个等级结构的产品时，抽象工厂模式将退化到工厂方法模式。</li>
</ol>
<h1 id="八、建造者模式"><a href="#八、建造者模式" class="headerlink" title="八、建造者模式"></a>八、建造者模式</h1><h2 id="8-1-定义"><a href="#8-1-定义" class="headerlink" title="8.1 定义"></a>8.1 定义</h2><ul>
<li>指将一个复杂对象的构造与它的表示分离，使同样的构建过程可以创建不同的表示，这样的设计模式被称为建造者模式</li>
</ul>
<h2 id="8-2-特点"><a href="#8-2-特点" class="headerlink" title="8.2 特点"></a>8.2 特点</h2><ul>
<li>它是将一个复杂的对象分解为多个简单的对 ，然后一步一步建而成。它将变与不变相分，即产品的组成部分是不变的，但每一部分是可以灵活选择的</li>
<li>计算机是由CPU、主板、内存、硬盘、显卡、机箱、显示器、键盘、鼠标等部件组装而成的，采购员不可能自己去组装计算机，而是将计算机的配置要求告诉计算书销售公司，计算机销售公司安排技术人员去组装计算机， 然后再交给要买计算机的采购员</li>
</ul>
<h2 id="8-3-优缺点"><a href="#8-3-优缺点" class="headerlink" title="8.3 优缺点"></a>8.3 优缺点</h2><ul>
<li>优点：<ul>
<li>具体的建造者相互独立，有利于系统的扩展。</li>
<li>客户端不必知道产品内部组成的细节，便于控制细节风险。</li>
</ul>
</li>
<li>缺点：<ul>
<li>产品的组成部分必须相同，这限制了其使用范围。</li>
<li>如果产品的内部变化复杂，该模式会增加很多的建造者类。</li>
</ul>
</li>
</ul>
<h2 id="8-4-工厂模式的区别"><a href="#8-4-工厂模式的区别" class="headerlink" title="8.4 工厂模式的区别"></a>8.4 工厂模式的区别</h2><ul>
<li>建造者模式和工厂模式的关注点不同，建造者模式注重零部件的组装过程，而工厂方法模式更注重零部件的创建过程，但两者可以结合使用。</li>
</ul>
<h2 id="8-5-结构"><a href="#8-5-结构" class="headerlink" title="8.5 结构"></a>8.5 结构</h2><ul>
<li>产品角色Product：它是包含多个组成部件的复杂对象，由具体建造者来创建其各个组成部件。</li>
<li>抽象建造者Builder：：它是 包含创建产品各个子部件的抽象方法的接口，通常还包个返回复杂产品的方法 getResult（）</li>
<li>具体建造者Concrete Builder：实现Builder接口，完成复杂产品的各个部件的具体创建方法</li>
<li>指挥者Director：它调用建造者对象中的部件构造与装配方法完成复杂对象的创建，在指挥者中不涉及具体产品的信息。</li>
</ul>
<h2 id="8-6-实现"><a href="#8-6-实现" class="headerlink" title="8.6 实现"></a>8.6 实现</h2><h3 id="8-6-1-产品角色"><a href="#8-6-1-产品角色" class="headerlink" title="8.6.1 产品角色"></a>8.6.1 产品角色</h3><ul>
<li>包含多个组成部件的复杂对象</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Product</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String partA;</span><br><span class="line">    <span class="keyword">private</span> String partB;</span><br><span class="line">    <span class="keyword">private</span> String partC;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPartA</span><span class="params">(String partA)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.partA = partA;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPartB</span><span class="params">(String partB)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.partB = partB;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPartC</span><span class="params">(String partC)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.partC = partC;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//显示产品的特性</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="8-6-2-抽象建造者"><a href="#8-6-2-抽象建造者" class="headerlink" title="8.6.2 抽象建造者"></a>8.6.2 抽象建造者</h3><ul>
<li>包含创建产品各个子部件的抽象方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Builder</span></span>&#123;</span><br><span class="line">    <span class="comment">// 创建产品对象</span></span><br><span class="line">    <span class="keyword">protected</span> Product product = <span class="keyword">new</span> Product();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildPartA</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildPartB</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildPartC</span><span class="params">()</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//返回产品对象</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">getResult</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> product;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="8-6-3-具体建造者"><a href="#8-6-3-具体建造者" class="headerlink" title="8.6.3 具体建造者"></a>8.6.3 具体建造者</h3><ul>
<li>实现了抽象建造者接口</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteBuilder</span> <span class="keyword">extends</span> <span class="title">Builder</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildPartA</span><span class="params">()</span></span>&#123;</span><br><span class="line">        product.setPartA(<span class="string">&quot;建造PartA&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildPartB</span><span class="params">()</span></span>&#123;</span><br><span class="line">        product.setPartB(<span class="string">&quot;建造PartB&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildPartC</span><span class="params">()</span></span>&#123;</span><br><span class="line">        product.setPartC(<span class="string">&quot;建造PartC&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="8-6-4-指挥者"><a href="#8-6-4-指挥者" class="headerlink" title="8.6.4 指挥者"></a>8.6.4 指挥者</h3><ul>
<li>调用建造者中的方法完成复杂对象的创建</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Director</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Builder builder;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Director</span><span class="params">(Builder builder)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.builder=builder;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//产品构建与组装方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        builder.buildPartA();</span><br><span class="line">        builder.buildPartB();</span><br><span class="line">        builder.buildPartC();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> builder.getResult();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="8-6-5-客户"><a href="#8-6-5-客户" class="headerlink" title="8.6.5 客户"></a>8.6.5 客户</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        Builder builder = <span class="keyword">new</span> ConcreteBuilder();</span><br><span class="line">        Director director = <span class="keyword">new</span> Director(builder);</span><br><span class="line">        Product product = director.construct();</span><br><span class="line">        product.show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="8-7-应用场景"><a href="#8-7-应用场景" class="headerlink" title="8.7 应用场景"></a>8.7 应用场景</h2><ol>
<li>创建的对象较复杂，由多个部件构成，各部件面临着复杂的变化，但构件间的建造顺序是<br>稳定的。</li>
<li>创建复杂对象的算法独立于该对象的组成部分以及它们的装配方式，即产品的构建过程和<br>最终的表示是独立</li>
</ol>
<h2 id="8-8-小结"><a href="#8-8-小结" class="headerlink" title="8.8 小结"></a>8.8 小结</h2><ul>
<li>建造者模式在应用过程中可以根据需要改变，如果创建的产品种类只有一种，只需要一个具体</li>
<li>建造者时，可省略略掉抽象建造者，甚至可以省略掉指挥者角色。</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://cnovelist.github.io/2022/03/26/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B04-Jena%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/yue.jpeg">
      <meta itemprop="name" content="故事开头">
      <meta itemprop="description" content="一个穷鬼">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="江小月不上頭">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/03/26/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B04-Jena%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/" class="post-title-link" itemprop="url">知识图谱学习笔记4-Jena使用教程</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-03-26 22:29:25" itemprop="dateCreated datePublished" datetime="2022-03-26T22:29:25+08:00">2022-03-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-04-19 21:04:06" itemprop="dateModified" datetime="2022-04-19T21:04:06+08:00">2022-04-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/" itemprop="url" rel="index"><span itemprop="name">知识图谱</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="一、SPARQL读取RDF数据"><a href="#一、SPARQL读取RDF数据" class="headerlink" title="一、SPARQL读取RDF数据"></a>一、SPARQL读取RDF数据</h1><h2 id="1-1-导入包"><a href="#1-1-导入包" class="headerlink" title="1.1 导入包"></a>1.1 导入包</h2><ul>
<li>先创建一个maven项目</li>
<li>引入以下包</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--解析SPARQL语句的引擎--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.jena<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jena-arq<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.17.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/junit/junit --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.13.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 日志包，防止报些奇怪的错误，程序能运行，但还是处理下 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-simple<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.25<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="1-2-创建数据"><a href="#1-2-创建数据" class="headerlink" title="1.2 创建数据"></a>1.2 创建数据</h2><ul>
<li>使用ttl存储三元组数据</li>
<li>在本地任意位置创建文件data.ttl，保存以下内容</li>
<li>也可以创建在项目里，以文本文件格式创建</li>
</ul>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># filename: ex002.ttl</span><br><span class="line"></span><br><span class="line">@prefix <span class="keyword">a</span><span class="variable">b:</span> &lt;http://learningsparql.<span class="keyword">com</span>/ns/addressbook#&gt; .</span><br><span class="line"></span><br><span class="line"><span class="keyword">a</span><span class="variable">b:richard</span> <span class="keyword">a</span><span class="variable">b:homeTel</span> <span class="string">&quot;(229) 276-5135&quot;</span> . </span><br><span class="line"><span class="keyword">a</span><span class="variable">b:richard</span> <span class="keyword">a</span><span class="variable">b:email</span>   <span class="string">&quot;richard49@hotmail.com&quot;</span> . </span><br><span class="line"></span><br><span class="line"><span class="keyword">a</span><span class="variable">b:cindy</span> <span class="keyword">a</span><span class="variable">b:homeTel</span> <span class="string">&quot;(245) 646-5488&quot;</span> . </span><br><span class="line"><span class="keyword">a</span><span class="variable">b:cindy</span> <span class="keyword">a</span><span class="variable">b:email</span>   <span class="string">&quot;cindym@gmail.com&quot;</span> . </span><br><span class="line"></span><br><span class="line"><span class="keyword">a</span><span class="variable">b:craig</span> <span class="keyword">a</span><span class="variable">b:homeTel</span> <span class="string">&quot;(194) 966-1505&quot;</span> . </span><br><span class="line"><span class="keyword">a</span><span class="variable">b:craig</span> <span class="keyword">a</span><span class="variable">b:email</span>   <span class="string">&quot;craigellis@yahoo.com&quot;</span> . </span><br><span class="line"><span class="keyword">a</span><span class="variable">b:craig</span> <span class="keyword">a</span><span class="variable">b:email</span>   <span class="string">&quot;c.ellis@usairwaysgroup.com&quot;</span> .</span><br></pre></td></tr></table></figure>
<h2 id="1-3-查询测试"><a href="#1-3-查询测试" class="headerlink" title="1.3 查询测试"></a>1.3 查询测试</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Model model = ModelFactory.createDefaultModel();</span><br><span class="line">    <span class="comment">//ttl文件路径</span></span><br><span class="line">    model.read(<span class="string">&quot;E:/ttl/data.ttl&quot;</span>);</span><br><span class="line">    <span class="comment">//查询语句, 查询craig的电子邮件地址</span></span><br><span class="line">    String queryString = <span class="string">&quot;PREFIX ab: &lt;http://learningsparql.com/ns/addressbook#&gt; \n&quot;</span> +</span><br><span class="line">        <span class="string">&quot;\n&quot;</span> +</span><br><span class="line">        <span class="string">&quot;SELECT ?craig_email\n&quot;</span> +</span><br><span class="line">        <span class="string">&quot;WHERE\n&quot;</span> +</span><br><span class="line">        <span class="string">&quot;&#123; ab:craig ab:email ?craig_email . &#125;&quot;</span>;</span><br><span class="line">    Query query = QueryFactory.create(queryString);</span><br><span class="line">    QueryExecution qe = QueryExecutionFactory.create(query, model);</span><br><span class="line">    ResultSet results = qe.execSelect();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 查询到的results是一个迭代器对象，需要while遍历输出查询到的值</span></span><br><span class="line">    <span class="keyword">while</span> (results.hasNext())&#123;</span><br><span class="line">            QuerySolution next = results.next();</span><br><span class="line">            System.out.println(next.get(<span class="string">&quot;?craig_email&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 输出结果</span></span><br><span class="line">    ResultSetFormatter.out(System.out, results, query);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="1-4-结果"><a href="#1-4-结果" class="headerlink" title="1.4 结果"></a>1.4 结果</h2><img src="/2022/03/26/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B04-Jena%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/jena.png" class="" title="res">
<h1 id="二、Jena读取OWL"><a href="#二、Jena读取OWL" class="headerlink" title="二、Jena读取OWL"></a>二、Jena读取OWL</h1><h2 id="2-1-读取owl文件"><a href="#2-1-读取owl文件" class="headerlink" title="2.1 读取owl文件"></a>2.1 读取owl文件</h2><ul>
<li>从本地读取</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">OntModel ontModel = ModelFactory.createOntologyModel();</span><br><span class="line">File myFile = <span class="keyword">new</span> File(<span class="string">&quot;E:/rdfData/owldemo1.owl&quot;</span>);</span><br><span class="line">ontModel.read(<span class="keyword">new</span> FileInputStream(myFile), <span class="string">&quot;&quot;</span>);</span><br></pre></td></tr></table></figure>
<h2 id="2-2-获取类信息"><a href="#2-2-获取类信息" class="headerlink" title="2.2 获取类信息"></a>2.2 获取类信息</h2><ul>
<li>遍历owl中定义的类，并打印类名</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (Iterator&lt;?&gt; i = ontModel.listClasses(); i.hasNext();) &#123;</span><br><span class="line">    OntClass c = (OntClass) i.next(); <span class="comment">// 返回类型强制转换</span></span><br><span class="line">    StmtIterator iterator = c.listProperties();	<span class="comment">// 获取该类的所有属性</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span>(iterator.hasNext())&#123;</span><br><span class="line">        Statement statement = iterator.next();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 获取关系信息</span></span><br><span class="line">        String predict = statement.getPredicate().toString().substring(statement.getPredicate().toString().indexOf(<span class="string">&quot;#&quot;</span>)+<span class="number">1</span>);</span><br><span class="line">        System.out.println(predict);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    System.out.println(c.getLocalName());	<span class="comment">//打印类名</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-3-获取类的实例"><a href="#2-3-获取类的实例" class="headerlink" title="2.3 获取类的实例"></a>2.3 获取类的实例</h2><ul>
<li>以下c表示所遍历的类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取该类下的所有实例迭代器</span></span><br><span class="line">ExtendedIterator&lt;? extends OntResource&gt; extendedIterator = c.listInstances();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 迭代器遍历</span></span><br><span class="line"><span class="keyword">while</span> (extendedIterator.hasNext())&#123;</span><br><span class="line">    OntResource resource = extendedIterator.next();	<span class="comment">// 获取类的实例</span></span><br><span class="line">    StmtIterator stmtIterator = resource.listProperties();	<span class="comment">// 获取实例中的所有属性列表，包括对象属性和数据属性</span></span><br><span class="line">    <span class="keyword">while</span>(stmtIterator.hasNext())&#123;</span><br><span class="line">        Statement statement = stmtIterator.next();</span><br><span class="line">        String object = statement.getObject().toString();</span><br><span class="line">        System.out.println(object);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="三、创建工具包"><a href="#三、创建工具包" class="headerlink" title="三、创建工具包"></a>三、创建工具包</h1>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://cnovelist.github.io/2022/03/26/redis%E5%9F%BA%E7%A1%80%E5%A4%A7%E5%85%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/yue.jpeg">
      <meta itemprop="name" content="故事开头">
      <meta itemprop="description" content="一个穷鬼">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="江小月不上頭">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/03/26/redis%E5%9F%BA%E7%A1%80%E5%A4%A7%E5%85%A8/" class="post-title-link" itemprop="url">Redis基础大全</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-03-26 18:40:56" itemprop="dateCreated datePublished" datetime="2022-03-26T18:40:56+08:00">2022-03-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-05-08 20:05:18" itemprop="dateModified" datetime="2022-05-08T20:05:18+08:00">2022-05-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%90%8E%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">后端</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%90%8E%E7%AB%AF/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="一、安装与配置"><a href="#一、安装与配置" class="headerlink" title="一、安装与配置"></a>一、安装与配置</h1><ol>
<li>安装gcc：<strong>yum install gcc -y</strong></li>
<li>下载redis-x.x.x.tar.gz，并解压：<strong>tar -zxvf redis-x.x.x.tar.gz</strong></li>
<li>进入redis解压目录，执行命令<strong>make和make install</strong>，不报错就表示安装成功，默认安装位置在<strong>/usr/local/bin</strong>目录下</li>
<li>开启redis后台启动，将<strong>redis解压目录</strong>下的<strong>redis.conf</strong>文件复制到其他位置，比如/etc目录下</li>
<li>修改<strong>redis.conf</strong>文件，找到<strong>daemonize</strong>字段，将其后的值no改为<strong>yes</strong>后，保存退出</li>
<li>执行命令<strong>redis-server /etc/redis.conf</strong>，即可后台开启redis</li>
<li>使用redis客户端访问redis服务，执行命令<strong>redis-cli</strong>进入redis客户端</li>
</ol>
<h1 id="二、Redis语法"><a href="#二、Redis语法" class="headerlink" title="二、Redis语法"></a>二、Redis语法</h1><h2 id="2-1-数据类型"><a href="#2-1-数据类型" class="headerlink" title="2.1 数据类型"></a>2.1 数据类型</h2><ul>
<li>字符串String</li>
<li>列表List</li>
<li>集合Set</li>
<li>哈希Hash</li>
<li>有序集合Zset</li>
</ul>
<h2 id="2-2-常用命令"><a href="#2-2-常用命令" class="headerlink" title="2.2 常用命令"></a>2.2 常用命令</h2><div class="table-container">
<table>
<thead>
<tr>
<th>命令</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>ping</td>
<td>查看服务是否正常运行</td>
</tr>
<tr>
<td>dbsize</td>
<td>查看当前数据库中key的数目（返回值为integer）</td>
</tr>
<tr>
<td>select 0</td>
<td>切换数据库，默认使用的是db0<br/>Redis默认操作16个数据库，序号为0~15</td>
</tr>
<tr>
<td>flushdb</td>
<td>删除当前操作的数据库中的内容</td>
</tr>
<tr>
<td>flushall</td>
<td>删除所有的库中的数据</td>
</tr>
<tr>
<td>keys pattern</td>
<td>查找所有符合pattern的key，pattern可以使用统配符</td>
</tr>
<tr>
<td>exists [key…]</td>
<td>判断key是否存在，存在key返回1，不存在返回0；<br/>使用多个key，则执行后返回key的数量</td>
</tr>
<tr>
<td>expire [key] [seconds]</td>
<td>设置key的生存时间，超过时间key自动删除；单位是秒；<br/>设置成功返回1，其他情况是0</td>
</tr>
<tr>
<td>ttl [key]</td>
<td>以秒为单位，返回key的剩余生存时间；<br/>-1：表示没有设置 key 的生存时间， key 永不过期；<br/>-2 ：表示key 不存在；其他表示剩余时间</td>
</tr>
<tr>
<td>type [key]</td>
<td>查看key所存储的数据类型</td>
</tr>
<tr>
<td>del [key…]</td>
<td>删除指定的key，不存在的key进行忽略；<br/>返回值：数字，删除的key的数量</td>
</tr>
</tbody>
</table>
</div>
<h2 id="2-3-字符串String"><a href="#2-3-字符串String" class="headerlink" title="2.3 字符串String"></a>2.3 字符串String</h2><ul>
<li>虽然给某个key设置的值是数字，但key的类型仍然是字符串，数字是以字符串的形式存储的，增加和减小操作也是基于字符串的操作</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>命令</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>set [key] [value]</td>
<td>将字符串值设置到key中；设置成功返回OK</td>
</tr>
<tr>
<td>get [key]</td>
<td>获取数据库中key的值；<br/>返回值：key对应的value值</td>
</tr>
<tr>
<td>incr [key]</td>
<td>将 key 中储存的数字值加 1<br/>如果 key 不存在，则创建 key 并初始化其值为 0 再执行incr 操作（只能对数字类型的数据操作）</td>
</tr>
<tr>
<td>decr [key]</td>
<td>与incr作用相反，是减1操作</td>
</tr>
<tr>
<td>append [key] [value]</td>
<td>字符串追加；<br/>如果 key 存在， 则将 value 追加到 key 原来旧值的末尾<br/>如果 key 不存在， 则将 key 设置值为 value；<br/>返回值：追加后的字符串总长度</td>
</tr>
<tr>
<td>strlen [key]</td>
<td>返回 key 所储存的字符串值的长度</td>
</tr>
<tr>
<td>getrange [key] [start] [end]</td>
<td>获取 key 中字符串值从 start 开始 到 end 结束 的子字符串,包括 start 和 end<br/>负数表示从字符串的末尾开始， -1 表示最后一个字符</td>
</tr>
<tr>
<td>setrange [key] [offset] [value]</td>
<td>用 value 覆盖（替换）key 的从offset位置开始存储的值<br/>不存在的 key ，在offset前填充空白字符<br/>返回值：修改后的字符串的长度</td>
</tr>
<tr>
<td>mset [key value…]</td>
<td>同时设置一个或多个 key-value<br/>返回值： OK</td>
</tr>
<tr>
<td>mget [key …]</td>
<td>获取所有(一个或多个)给定 key 的值<br/>包含所有 key 的列表</td>
</tr>
</tbody>
</table>
</div>
<h2 id="2-4-列表List"><a href="#2-4-列表List" class="headerlink" title="2.4 列表List"></a>2.4 列表List</h2><h3 id="2-4-1-原理"><a href="#2-4-1-原理" class="headerlink" title="2.4.1 原理"></a>2.4.1 原理</h3><ul>
<li>单键多值</li>
<li>底层：双向链表</li>
</ul>
<h3 id="2-4-2-命令"><a href="#2-4-2-命令" class="headerlink" title="2.4.2 命令"></a>2.4.2 命令</h3><div class="table-container">
<table>
<thead>
<tr>
<th>命令</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>lpush/rpush key [value…]</td>
<td>从左/右侧将一个或多个值 value 插入到列表 key 的表头<br/>从左侧插入属于头插法，列表顺序为倒序<br/>返回值：数字，新列表的长度</td>
</tr>
<tr>
<td>lpop/rpop</td>
<td></td>
</tr>
<tr>
<td>rpoplpush</td>
<td></td>
</tr>
<tr>
<td>lrange [key] [start] [stop]</td>
<td>获取列表 key 中指定区间内的元素，0表示第一个元素，-1为最后一个元素<br/>返回值：指定区间的列表</td>
</tr>
<tr>
<td>lindex [key] [index]</td>
<td>获取列表 key 中下标为指定 index 的元素<br/>返回值：指定下标的元素；index 不在列表范围，返回 nil</td>
</tr>
<tr>
<td>llen [key]</td>
<td>获取列表 key 的长度<br/>返回值：数值，列表的长度； key 不存在返回 0</td>
</tr>
<tr>
<td>lrem [key] [count] [value]</td>
<td>移除列表中count个与value相等的元素<br/>count&gt;0从列表左侧开始移除；<br/>count<0从列表右侧开始移除；<br/>count=0移除表中所有与 value 相等的值</td>
</tr>
<tr>
<td>lset [key] [index] [value]</td>
<td>将列表 key 下标为 index 的元素的值设置为 value<br/>返回值：设置成功返回 ok ; key 不存在或者 index 超出范围返回错误信息</td>
</tr>
</tbody>
</table>
</div>
<h2 id="2-5-集合Set"><a href="#2-5-集合Set" class="headerlink" title="2.5 集合Set"></a>2.5 集合Set</h2><h3 id="2-5-1-原理"><a href="#2-5-1-原理" class="headerlink" title="2.5.1 原理"></a>2.5.1 原理</h3><ul>
<li>底层：hash表</li>
</ul>
<h3 id="2-5-2-命令"><a href="#2-5-2-命令" class="headerlink" title="2.5.2 命令"></a>2.5.2 命令</h3><div class="table-container">
<table>
<thead>
<tr>
<th>命令</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>sadd [key] [member…]</td>
<td>将一个或多个 member 元素加入到集合 key 当中，已经存在于集合的 member 元素将被忽略，不会再加入。<br/>返回值：加入到集合的新元素的个数。不包括被忽略的元素</td>
</tr>
<tr>
<td>smembers [key]</td>
<td>获取集合 key 中的所有成员元素，不存在的 key 视为空集合</td>
</tr>
<tr>
<td>sismember [key] [member]</td>
<td>判断 member 元素是否是集合 key 的成员返回值：member 是集合成员返回 1，其他返回 0</td>
</tr>
<tr>
<td>scard [key]</td>
<td>获取集合里面的元素个数<br/>返回值：数字，key 的元素个数。 其他情况返回 0</td>
</tr>
<tr>
<td>srem [key] [member…]</td>
<td>删除集合 key 中的一个或多个 member 元素，不存在的元素被忽略<br/>返回值：数字，成功删除的元素个数，不包括被忽略的元素。</td>
</tr>
</tbody>
</table>
</div>
<h2 id="2-6-有序集合Zset"><a href="#2-6-有序集合Zset" class="headerlink" title="2.6 有序集合Zset"></a>2.6 有序集合Zset</h2><h3 id="2-6-1-原理"><a href="#2-6-1-原理" class="headerlink" title="2.6.1 原理"></a>2.6.1 原理</h3><h3 id="2-6-2-命令"><a href="#2-6-2-命令" class="headerlink" title="2.6.2 命令"></a>2.6.2 命令</h3><div class="table-container">
<table>
<thead>
<tr>
<th>命令</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>zadd [key] [[score] member…]</td>
<td>将一个或多个 member 元素及其 score 值加入到有序集合 key 中，如果 member存在集合中，则更新值；score 可以是整数或浮点数<br/>返回值：数字，新添加的元素个数</td>
</tr>
<tr>
<td>zrange [key] [start] [stop] [WITHSCORES]</td>
<td>查询有序集合，指定区间的内的元素。集合成员按 score 值从小到大来排序<br/>WITHSCORES 选项让 score 和 value 一同返回</td>
</tr>
<tr>
<td>zrem [key] [member…]</td>
<td>删除有序集合 key 中的一个或多个成员，不存在的成员被忽略<br/>返回值：被成功删除的成员数量，不包括被忽略的成员。</td>
</tr>
<tr>
<td>zcard [key]</td>
<td>获取有序集 key 的元素成员的个数<br/>返回值：key 存在返回集合元素的个数， key 不存在，返回 0</td>
</tr>
</tbody>
</table>
</div>
<h1 id="三、Redis配置文件"><a href="#三、Redis配置文件" class="headerlink" title="三、Redis配置文件"></a>三、Redis配置文件</h1><h1 id="四、Redis发布和订阅"><a href="#四、Redis发布和订阅" class="headerlink" title="四、Redis发布和订阅"></a>四、Redis发布和订阅</h1><h2 id="4-1-简介"><a href="#4-1-简介" class="headerlink" title="4.1 简介"></a>4.1 简介</h2><ul>
<li>发布和订阅是一种信息通信模式：发送者（pub）发送消息，订阅者（sub）接收信息</li>
<li>Redis客户端可以订阅任意数量的频道</li>
</ul>
<h2 id="4-2-示例"><a href="#4-2-示例" class="headerlink" title="4.2 示例"></a>4.2 示例</h2><ul>
<li>打开两个redis客户端，分别为A、B，A为发送者，B为订阅者</li>
<li>A执行命令<strong>public channel1 hello</strong>，表示向channel1频道发布信息hello<ul>
<li>命令执行后的返回值表示<strong>订阅者的数量</strong></li>
</ul>
</li>
<li>B执行命令<strong>SUBSCRIBE channel1</strong>，表示接收channel1的频道<ul>
<li>返回的是频道的信息列表</li>
</ul>
</li>
</ul>
<h1 id="五、其他数据类型"><a href="#五、其他数据类型" class="headerlink" title="五、其他数据类型"></a>五、其他数据类型</h1><h2 id="5-1-Bitmaps"><a href="#5-1-Bitmaps" class="headerlink" title="5.1 Bitmaps"></a>5.1 Bitmaps</h2><h3 id="5-1-1-原理"><a href="#5-1-1-原理" class="headerlink" title="5.1.1 原理"></a>5.1.1 原理</h3><ul>
<li><p>存储二进制的字符串，比如user=00001</p>
<ul>
<li>其中value为00001在Redis中依旧是以字符串的形式存储的</li>
<li>偏移量offset从0开始算起，这里value中1的偏移量就是4</li>
<li>想要得到以上的KV对，需要执行命令setbit user 4 1</li>
</ul>
</li>
<li><p>Bitmaps可以用来保存用户活跃度，Set集合也可以做，但两者有区别</p>
<ul>
<li>当用户活跃量特别大时，使用Bitmaps可以极大的减少存储空间</li>
<li>当用户活跃量比较小时，使用Set集合则比较合适</li>
</ul>
</li>
</ul>
<h3 id="5-1-2-命令"><a href="#5-1-2-命令" class="headerlink" title="5.1.2 命令"></a>5.1.2 命令</h3><div class="table-container">
<table>
<thead>
<tr>
<th>命令</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>setbit [key] [offset] [value]</td>
<td>将key的offset位置的值设置为value</td>
</tr>
<tr>
<td>getbit [key] [offset]</td>
<td>获取key中offset位置的值</td>
</tr>
<tr>
<td>bitcount [key] [start,end]</td>
<td>不指定[start,end]时，统计key中value所有被设置为1的bit个数<br/>指定[start,end]时，这里的start和end表示的是字节下标，[1,2]表示统计<strong>第一个字节（8位）</strong>到第二个字节中1的个数，[0,-2]则表示统计从0到倒数第二个字节中1个数</td>
</tr>
</tbody>
</table>
</div>
<h2 id="5-2-HyperLogLog"><a href="#5-2-HyperLogLog" class="headerlink" title="5.2 HyperLogLog"></a>5.2 HyperLogLog</h2><h3 id="5-2-1-原理"><a href="#5-2-1-原理" class="headerlink" title="5.2.1 原理"></a>5.2.1 原理</h3><ul>
<li>计算<strong>基数（集合中不重复元素个数）</strong>的一种算法</li>
<li>对比Set，所占内存更小，统计的范围更大，重复的元素不会被添加进去</li>
</ul>
<h3 id="5-2-2-命令"><a href="#5-2-2-命令" class="headerlink" title="5.2.2 命令"></a>5.2.2 命令</h3><div class="table-container">
<table>
<thead>
<tr>
<th>命令</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>pfadd [key] [element…]</td>
<td>添加指定元素到HyperLogLog中<br/>返回值：添加<strong>重复元素</strong>返回0，添加<strong>不重复元素</strong>返回1</td>
</tr>
<tr>
<td>pfcount [key…]</td>
<td>统计某个key的基数个数</td>
</tr>
<tr>
<td>pfmerge [destkey] [sourcekey…]</td>
<td>合并多个sourcekey后，将结果存放到destkey中</td>
</tr>
</tbody>
</table>
</div>
<h2 id="5-3-Geospatial"><a href="#5-3-Geospatial" class="headerlink" title="5.3 Geospatial"></a>5.3 Geospatial</h2><h3 id="5-3-1-原理"><a href="#5-3-1-原理" class="headerlink" title="5.3.1 原理"></a>5.3.1 原理</h3><ul>
<li>存放地理信息的数据结构，即表示经纬度的二维坐标</li>
</ul>
<h3 id="5-3-2-命令"><a href="#5-3-2-命令" class="headerlink" title="5.3.2 命令"></a>5.3.2 命令</h3><div class="table-container">
<table>
<thead>
<tr>
<th>命令</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>geoadd [key] [[longitude] [latitude] [menber]…]</td>
<td>添加地理位置信息，（经度，纬度，名称）<br/>示例：geoadd china 100 100 shanghai 120 120 beijin</td>
</tr>
<tr>
<td>geopos [key] [member…]</td>
<td>获取key中名称位member的经纬度坐标</td>
</tr>
<tr>
<td>geodist [key] [member1] [member2] [m\</td>
<td>km\</td>
<td>ft\</td>
<td>mi]</td>
<td>获取key中member1和member2的直线距离，后面可以设置单位，m为默认单位</td>
</tr>
<tr>
<td>georadius [key] [longitude] [latitude] radius m\</td>
<td>km\</td>
<td>ft\</td>
<td>mi</td>
<td>以给定的经纬度坐标为中心，找出key中包含在半径为radius的圆中的member名称列表</td>
</tr>
</tbody>
</table>
</div>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://cnovelist.github.io/2022/03/26/nginx%E5%9F%BA%E7%A1%80%E5%A4%A7%E5%85%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/yue.jpeg">
      <meta itemprop="name" content="故事开头">
      <meta itemprop="description" content="一个穷鬼">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="江小月不上頭">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/03/26/nginx%E5%9F%BA%E7%A1%80%E5%A4%A7%E5%85%A8/" class="post-title-link" itemprop="url">nginx基础大全</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-03-26 18:40:22 / 修改时间：18:47:01" itemprop="dateCreated datePublished" datetime="2022-03-26T18:40:22+08:00">2022-03-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%90%8E%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">后端</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%90%8E%E7%AB%AF/%E6%9C%8D%E5%8A%A1%E5%99%A8/" itemprop="url" rel="index"><span itemprop="name">服务器</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="一、Nginx简介"><a href="#一、Nginx简介" class="headerlink" title="一、Nginx简介"></a>一、Nginx简介</h1>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://cnovelist.github.io/2022/03/25/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B03-%E8%AE%BA%E6%96%87%E5%86%99%E4%BD%9C%E6%8C%87%E5%AF%BC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/yue.jpeg">
      <meta itemprop="name" content="故事开头">
      <meta itemprop="description" content="一个穷鬼">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="江小月不上頭">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/03/25/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B03-%E8%AE%BA%E6%96%87%E5%86%99%E4%BD%9C%E6%8C%87%E5%AF%BC/" class="post-title-link" itemprop="url">知识图谱学习笔记3-论文写作指导</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-03-25 22:28:39" itemprop="dateCreated datePublished" datetime="2022-03-25T22:28:39+08:00">2022-03-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-04-08 22:13:03" itemprop="dateModified" datetime="2022-04-08T22:13:03+08:00">2022-04-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/" itemprop="url" rel="index"><span itemprop="name">知识图谱</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="一、论文投稿"><a href="#一、论文投稿" class="headerlink" title="一、论文投稿"></a>一、论文投稿</h1><h2 id="1-1-期刊和会议的区别"><a href="#1-1-期刊和会议的区别" class="headerlink" title="1.1 期刊和会议的区别"></a>1.1 期刊和会议的区别</h2><ul>
<li>针对方向不同：<ul>
<li>会议论文是针对学术会议投稿，会务组觉得是否录用</li>
<li>期刊论文是针对某学术期刊投稿，期刊编辑部决定是否录用，审稿人只做审稿并返回意见</li>
</ul>
</li>
<li>审稿周期不同：<ul>
<li>会议的审稿周期一般比较短，2周左右，野鸡的则更短</li>
<li>国内中文核心期刊一般2个月，普刊也要1-3周左右，水刊则更短</li>
</ul>
</li>
</ul>
<h2 id="1-2-EI检索"><a href="#1-2-EI检索" class="headerlink" title="1.2 EI检索"></a>1.2 EI检索</h2><h2 id="1-3-核心期刊"><a href="#1-3-核心期刊" class="headerlink" title="1.3 核心期刊"></a>1.3 核心期刊</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://cnovelist.github.io/2022/03/17/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B02-%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E6%9E%84%E5%BB%BA%E6%8A%80%E6%9C%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/yue.jpeg">
      <meta itemprop="name" content="故事开头">
      <meta itemprop="description" content="一个穷鬼">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="江小月不上頭">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/03/17/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B02-%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E6%9E%84%E5%BB%BA%E6%8A%80%E6%9C%AF/" class="post-title-link" itemprop="url">知识图谱学习笔记2-知识图谱构建技术</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-03-17 21:15:01" itemprop="dateCreated datePublished" datetime="2022-03-17T21:15:01+08:00">2022-03-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-03-26 21:30:25" itemprop="dateModified" datetime="2022-03-26T21:30:25+08:00">2022-03-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/" itemprop="url" rel="index"><span itemprop="name">知识图谱</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="SPARQL语言"><a href="#SPARQL语言" class="headerlink" title="SPARQL语言"></a>SPARQL语言</h1><h1 id="一、OWL本体库语言"><a href="#一、OWL本体库语言" class="headerlink" title="一、OWL本体库语言"></a>一、OWL本体库语言</h1><h1 id="二、RDF"><a href="#二、RDF" class="headerlink" title="二、RDF"></a>二、RDF</h1><h2 id="2-1-RDF介绍"><a href="#2-1-RDF介绍" class="headerlink" title="2.1 RDF介绍"></a>2.1 RDF介绍</h2><ul>
<li>RDF全称为资源描述框架</li>
<li>该数据模型由三个部分组成事实，被称为三元组triples：(主，谓，宾)</li>
<li>如下表所示，下表为一条邮箱的事实</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>subject</th>
<th>predicate</th>
<th>object</th>
</tr>
</thead>
<tbody>
<tr>
<td>gy</td>
<td>email</td>
<td>7777777@qq.com</td>
</tr>
</tbody>
</table>
</div>
<h2 id="2-2-RDF资源"><a href="#2-2-RDF资源" class="headerlink" title="2.2 RDF资源"></a>2.2 RDF资源</h2><ul>
<li>RDF图中有三种节点：IRIs（国际资源标识符），literals（文字）和空节点<ul>
<li>IRIs是一个Unicode字符串</li>
</ul>
</li>
</ul>
<img src="/2022/03/17/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B02-%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E6%9E%84%E5%BB%BA%E6%8A%80%E6%9C%AF/rdfgraph.png" class="" title="rdfgraph">
<ul>
<li>谓语本身也是一个IRIs，表示一个属性，可以认为是二元关系的<strong>资源</strong></li>
</ul>
<h2 id="2-3-RDF图"><a href="#2-3-RDF图" class="headerlink" title="2.3 RDF图"></a>2.3 RDF图</h2><h3 id="2-3-1-三元组"><a href="#2-3-1-三元组" class="headerlink" title="2.3.1 三元组"></a>2.3.1 三元组</h3><ul>
<li>一个RDF三元组由三个部分组成<ul>
<li>主语：它是一个IRI或者一个空节点</li>
<li>谓语：它是一个IRI</li>
<li>宾语：它是一个IRI或者文字或者空节点</li>
</ul>
</li>
</ul>
<h2 id="2-3-2-URL，URI和IRI"><a href="#2-3-2-URL，URI和IRI" class="headerlink" title="2.3.2 URL，URI和IRI"></a>2.3.2 URL，URI和IRI</h2><ul>
<li>URL：统一资源定位符，表示互联网资源的位置访问地址</li>
<li>URI：统一资源标识符，在三元组中可以标识主语、谓语的<strong>命名空间</strong>，以免命名混淆</li>
<li>IRI：国际资源标识符</li>
</ul>
<h1 id="三、ttl数据格式"><a href="#三、ttl数据格式" class="headerlink" title="三、ttl数据格式"></a>三、ttl数据格式</h1><h2 id="3-1-简单的三元组"><a href="#3-1-简单的三元组" class="headerlink" title="3.1 简单的三元组"></a>3.1 简单的三元组</h2><ul>
<li>每个三元组满足&lt;主 谓 宾&gt;，且每个三元组以”.”结尾</li>
</ul>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;http:<span class="regexp">//</span>example.org<span class="regexp">/#spiderman&gt; &lt;http:/</span><span class="regexp">/www.perceive.net/</span>schemas<span class="regexp">/relationship/</span>enemyOf&gt; &lt;http:<span class="regexp">//</span>example.org/<span class="comment">#green-goblin&gt; .</span></span><br></pre></td></tr></table></figure>
<h2 id="3-2-简单格式"><a href="#3-2-简单格式" class="headerlink" title="3.2 简单格式"></a>3.2 简单格式</h2><ul>
<li>RDF有许多文件格式，以下以Turtle RDF格式为例，文件名为data.ttl</li>
<li>对于以下文件格式，后面会做详细介绍</li>
</ul>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># filename: ex002.ttl</span><br><span class="line"></span><br><span class="line"># 前缀行，<span class="keyword">ab</span>表示的是后面URI的别名，方便后面表示</span><br><span class="line">@prefix <span class="keyword">a</span><span class="variable">b:</span> &lt;http://learningsparql.<span class="keyword">com</span>/ns/addressbook#&gt; .</span><br><span class="line"></span><br><span class="line"># 以下每行都表示一个三元组，其中<span class="keyword">ab</span>为前缀</span><br><span class="line"><span class="keyword">a</span><span class="variable">b:richard</span> <span class="keyword">a</span><span class="variable">b:homeTel</span> <span class="string">&quot;(229) 276-5135&quot;</span> . </span><br><span class="line"><span class="keyword">a</span><span class="variable">b:richard</span> <span class="keyword">a</span><span class="variable">b:email</span>   <span class="string">&quot;richard49@hotmail.com&quot;</span> . </span><br><span class="line"></span><br><span class="line"><span class="keyword">a</span><span class="variable">b:cindy</span> <span class="keyword">a</span><span class="variable">b:homeTel</span> <span class="string">&quot;(245) 646-5488&quot;</span> . </span><br><span class="line"><span class="keyword">a</span><span class="variable">b:cindy</span> <span class="keyword">a</span><span class="variable">b:email</span>   <span class="string">&quot;cindym@gmail.com&quot;</span> . </span><br><span class="line"></span><br><span class="line"><span class="keyword">a</span><span class="variable">b:craig</span> <span class="keyword">a</span><span class="variable">b:homeTel</span> <span class="string">&quot;(194) 966-1505&quot;</span> . </span><br><span class="line"><span class="keyword">a</span><span class="variable">b:craig</span> <span class="keyword">a</span><span class="variable">b:email</span>   <span class="string">&quot;craigellis@yahoo.com&quot;</span> . </span><br><span class="line"><span class="keyword">a</span><span class="variable">b:craig</span> <span class="keyword">a</span><span class="variable">b:email</span>   <span class="string">&quot;c.ellis@usairwaysgroup.com&quot;</span> .</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="3-3-谓词表"><a href="#3-3-谓词表" class="headerlink" title="3.3 谓词表"></a>3.3 谓词表</h2><ul>
<li>以下数据标注了蜘蛛侠的敌人和名字</li>
<li><p>也就是说相同的主语有多个的谓词关系时需要用”;”分隔，形式如下：</p>
</li>
<li><p>主语 谓词1 宾语1;</p>
<ul>
<li>谓词2 宾语2.</li>
</ul>
</li>
<li>当然也可以分开写成两个三元组也是可以的</li>
</ul>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;http:<span class="regexp">//</span>example.org<span class="regexp">/#spiderman&gt; &lt;http:/</span><span class="regexp">/www.perceive.net/</span>schemas<span class="regexp">/relationship/</span>enemyOf&gt; &lt;http:<span class="regexp">//</span>example.org/<span class="comment">#green-goblin&gt; ;</span></span><br><span class="line">				&lt;http:<span class="regexp">//</span>xmlns.com<span class="regexp">/foaf/</span><span class="number">0.1</span>/name&gt; <span class="string">&quot;Spiderman&quot;</span> .</span><br></pre></td></tr></table></figure>
<h2 id="3-4-宾语表"><a href="#3-4-宾语表" class="headerlink" title="3.4 宾语表"></a>3.4 宾语表</h2><ul>
<li>主语对于相同谓词拥有多个宾语的情况</li>
</ul>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;http:<span class="regexp">//</span>example.org<span class="regexp">/#spiderman&gt; &lt;http:/</span><span class="regexp">/xmlns.com/</span>foaf<span class="regexp">/0.1/</span>name&gt; <span class="string">&quot;Spiderman&quot;</span>, <span class="string">&quot;Человек-паук&quot;</span>@ru .</span><br></pre></td></tr></table></figure>
<ul>
<li>当然也可以分开写成两个三元组也是可以的</li>
</ul>
<h2 id="3-5-RDF概念支持"><a href="#3-5-RDF概念支持" class="headerlink" title="3.5 RDF概念支持"></a>3.5 RDF概念支持</h2><h3 id="3-5-1-IRI"><a href="#3-5-1-IRI" class="headerlink" title="3.5.1 IRI"></a>3.5.1 IRI</h3><ul>
<li>使用@prefix/PREFIX或者@base/BASE来表示IRI，简化三元组的编写，可以理解为为IRI起别名</li>
<li>以下为@prefix使用例子</li>
</ul>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用PREFIX也是同样效果</span></span><br><span class="line">@prefix somePrefix: &lt;http:<span class="regexp">//</span>www.perceive.net<span class="regexp">/schemas/</span>relationship/&gt; .</span><br><span class="line"></span><br><span class="line">&lt;http:<span class="regexp">//</span>example.org<span class="regexp">/#green-goblin&gt; somePrefix:enemyOf &lt;http:/</span><span class="regexp">/example.org/</span><span class="comment">#spiderman&gt; .</span></span><br></pre></td></tr></table></figure>
<ul>
<li>以下为@base使用例子</li>
<li>可以理解为相对地址的写法</li>
</ul>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># A triple with all absolute IRIs</span></span><br><span class="line">&lt;http:<span class="regexp">//</span>one.example<span class="regexp">/subject1&gt; &lt;http:/</span><span class="regexp">/one.example/</span>predicate1&gt; &lt;http:<span class="regexp">//</span>one.example/object1&gt; .</span><br><span class="line"></span><br><span class="line">@base &lt;http:<span class="regexp">//</span>one.example/&gt; .	<span class="comment"># 标记主地址</span></span><br><span class="line">&lt;subject2&gt; &lt;predicate2&gt; &lt;object2&gt; .     <span class="comment"># 相对 IRIs, e.g. http://one.example/subject2</span></span><br></pre></td></tr></table></figure>
<ul>
<li>也可以使用空前缀</li>
</ul>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@prefix :</span> &lt;<span class="attribute">http</span>:<span class="comment">//another.example/&gt; .    # empty prefix</span></span><br><span class="line">:<span class="attribute">subject5 </span>:<span class="attribute">predicate5 </span>:object5 .        # prefixed name, e.g. <span class="attribute">http</span>:<span class="comment">//another.example/subject5</span></span><br></pre></td></tr></table></figure>
<h1 id="四、SPARQL语言"><a href="#四、SPARQL语言" class="headerlink" title="四、SPARQL语言"></a>四、SPARQL语言</h1><h2 id="4-1-一个简单的查询语句"><a href="#4-1-一个简单的查询语句" class="headerlink" title="4.1 一个简单的查询语句"></a>4.1 一个简单的查询语句</h2><ul>
<li><p>SPARQL是专门针对RDF的的查询语句</p>
</li>
<li><p>SELECT后面的?xxx表示要查询的变量</p>
</li>
<li>WHERE后是对应的三元组{ ab:craig ab:email ?craig_email . }，它们满足主/谓/宾的关系</li>
<li>这条语言的作用就是查询craig的emal</li>
</ul>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义好命名空间的别名</span></span><br><span class="line">PREFIX ab: &lt;http:<span class="regexp">//</span>learningsparql.com<span class="regexp">/ns/</span>addressbook<span class="comment">#&gt; </span></span><br><span class="line"></span><br><span class="line">SELECT ?craig_email</span><br><span class="line">WHERE</span><br><span class="line">&#123; ab:craig ab:email ?craig_email . &#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-2-多重匹配"><a href="#3-2-多重匹配" class="headerlink" title="3.2 多重匹配"></a>3.2 多重匹配</h2><ul>
<li>多重匹配返回的结果是多个属性的结果集</li>
<li>以下由三个对象的三元组，a和b都有姓名和邮箱，c只有一个邮箱</li>
</ul>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@prefix</span> foaf： &lt;<span class="attribute">http</span>:<span class="comment">//xmlns.com/foaf/0.1/&gt; 。</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">_</span>:a <span class="attribute">foaf</span>:name <span class="string">&quot;Johnny Lee Outlaw&quot;</span> 。</span><br><span class="line"><span class="attribute">_</span>:a <span class="attribute">foaf</span>:mbox &lt;<span class="attribute">mailto</span>:jlow<span class="variable">@example</span>.com&gt; 。</span><br><span class="line"><span class="attribute">_</span>:b <span class="attribute">foaf</span>:name <span class="string">&quot;Peter Goodguy&quot;</span> 。</span><br><span class="line"><span class="attribute">_</span>:b <span class="attribute">foaf</span>:mbox &lt;<span class="attribute">mailto</span>:peter<span class="variable">@example</span>.org&gt; 。</span><br><span class="line"><span class="attribute">_</span>:c <span class="attribute">foaf</span>:mbox &lt;<span class="attribute">mailto</span>:carol<span class="variable">@example</span>.org&gt; 。</span><br></pre></td></tr></table></figure>
<ul>
<li>查询姓名和邮箱<ul>
<li>如果要查询相同主语所对应的宾语信息列表，可以使用以下方式</li>
</ul>
</li>
</ul>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PREFIX <span class="symbol">foaf:</span>   &lt;<span class="symbol">http:</span>/<span class="regexp">/xmlns.com/foaf</span><span class="regexp">/0.1/</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询语句要提取的是姓名和邮箱</span></span><br><span class="line"><span class="comment"># where匹配的意思是，相同的x对应的姓名和邮箱信息</span></span><br><span class="line"><span class="comment"># 这里就可以查到a/b所对应的姓名和邮箱信息</span></span><br><span class="line">SELECT <span class="string">?n</span>ame <span class="string">?m</span>box</span><br><span class="line">WHERE</span><br><span class="line">  &#123; <span class="string">?x</span> <span class="symbol">foaf:</span>name <span class="string">?n</span>ame .</span><br><span class="line">    <span class="string">?x</span> <span class="symbol">foaf:</span>mbox <span class="string">?m</span>box &#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://cnovelist.github.io/2022/03/17/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E5%8F%91%E5%B1%95%E7%BB%BC%E8%BF%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/yue.jpeg">
      <meta itemprop="name" content="故事开头">
      <meta itemprop="description" content="一个穷鬼">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="江小月不上頭">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/03/17/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01-%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E5%8F%91%E5%B1%95%E7%BB%BC%E8%BF%B0/" class="post-title-link" itemprop="url">知识图谱学习笔记1-知识图谱发展综述</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-03-17 21:12:56 / 修改时间：21:19:29" itemprop="dateCreated datePublished" datetime="2022-03-17T21:12:56+08:00">2022-03-17</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/" itemprop="url" rel="index"><span itemprop="name">知识图谱</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="一、知识图谱简介"><a href="#一、知识图谱简介" class="headerlink" title="一、知识图谱简介"></a>一、知识图谱简介</h1><h1 id="二、知识表示"><a href="#二、知识表示" class="headerlink" title="二、知识表示"></a>二、知识表示</h1><h1 id="三、知识融合"><a href="#三、知识融合" class="headerlink" title="三、知识融合"></a>三、知识融合</h1><h1 id="四、知识抽取"><a href="#四、知识抽取" class="headerlink" title="四、知识抽取"></a>四、知识抽取</h1><h2 id="4-1-实体抽取"><a href="#4-1-实体抽取" class="headerlink" title="4.1 实体抽取"></a>4.1 实体抽取</h2><h2 id="4-2-关系抽取"><a href="#4-2-关系抽取" class="headerlink" title="4.2 关系抽取"></a>4.2 关系抽取</h2><h1 id="五、知识图谱应用"><a href="#五、知识图谱应用" class="headerlink" title="五、知识图谱应用"></a>五、知识图谱应用</h1><h2 id="5-1-推荐技术"><a href="#5-1-推荐技术" class="headerlink" title="5.1 推荐技术"></a>5.1 推荐技术</h2><h2 id="5-2-知识推理"><a href="#5-2-知识推理" class="headerlink" title="5.2 知识推理"></a>5.2 知识推理</h2><h2 id="5-3-自动问答"><a href="#5-3-自动问答" class="headerlink" title="5.3 自动问答"></a>5.3 自动问答</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://cnovelist.github.io/2022/03/14/Mybatis%E5%9F%BA%E7%A1%80%E5%A4%A7%E5%85%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/yue.jpeg">
      <meta itemprop="name" content="故事开头">
      <meta itemprop="description" content="一个穷鬼">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="江小月不上頭">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/03/14/Mybatis%E5%9F%BA%E7%A1%80%E5%A4%A7%E5%85%A8/" class="post-title-link" itemprop="url">Mybatis基础大全</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-03-14 17:27:50" itemprop="dateCreated datePublished" datetime="2022-03-14T17:27:50+08:00">2022-03-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-03-29 20:34:29" itemprop="dateModified" datetime="2022-03-29T20:34:29+08:00">2022-03-29</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%90%8E%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">后端</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%90%8E%E7%AB%AF/SSM%E6%A1%86%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">SSM框架</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="一、Mybatis"><a href="#一、Mybatis" class="headerlink" title="一、Mybatis"></a>一、Mybatis</h1><h2 id="1-1-简介"><a href="#1-1-简介" class="headerlink" title="1.1 简介"></a>1.1 简介</h2><ul>
<li>优秀的持久层框架</li>
</ul>
<h2 id="1-2-持久层"><a href="#1-2-持久层" class="headerlink" title="1.2 持久层"></a>1.2 持久层</h2><ul>
<li>持久化：将程序的数据在持久状态和瞬时状态转化的过程</li>
<li>内存：断电即失</li>
</ul>
<h1 id="二、第一个案例"><a href="#二、第一个案例" class="headerlink" title="二、第一个案例"></a>二、第一个案例</h1><h2 id="2-1-导入依赖包与资源路径"><a href="#2-1-导入依赖包与资源路径" class="headerlink" title="2.1 导入依赖包与资源路径"></a>2.1 导入依赖包与资源路径</h2><h3 id="2-1-1-导入依赖包"><a href="#2-1-1-导入依赖包" class="headerlink" title="2.1.1 导入依赖包"></a>2.1.1 导入依赖包</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--    mysql驱动    --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- https://mvnrepository.com/artifact/mysql/mysql-connector-java --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--    mybatis    --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.mybatis/mybatis --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--    junit    --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- https://mvnrepository.com/artifact/junit/junit --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.13.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="2-1-2-配置maven资源路径"><a href="#2-1-2-配置maven资源路径" class="headerlink" title="2.1.2 配置maven资源路径"></a>2.1.2 配置maven资源路径</h3><ul>
<li>在pom文件中添加以下内容，防止项目运行时，代码层的xml文件由于不在默认的resource资源目录中，导致访问失败而报错，父/子模块的pom都可以添加进去</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--  配置资源导出,防止dao层中的xml无法访问而报错  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="2-2-配置Mybatis-xml文件"><a href="#2-2-配置Mybatis-xml文件" class="headerlink" title="2.2 配置Mybatis.xml文件"></a>2.2 配置Mybatis.xml文件</h2><ul>
<li>在resource下创建Mybatis.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">由于hexo头信息无法复制，因此以注释的形式标注出来</span></span><br><span class="line"><span class="comment">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="comment">&lt;!DOCTYPE configuration</span></span><br><span class="line"><span class="comment">        PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span><br><span class="line"><span class="comment">        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--核心配置文件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;com.mysql.cj.jdbc.Driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc:mysql://localhost:3306/mybatis?useSSL=true<span class="symbol">&amp;amp;</span>useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=UTF-8&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;root&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;FLzxSQC1998.Com&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;com/kuang/dao/UserMapper.xml&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="2-3-编写代码"><a href="#2-3-编写代码" class="headerlink" title="2.3 编写代码"></a>2.3 编写代码</h2><h3 id="2-3-1-编写工具类"><a href="#2-3-1-编写工具类" class="headerlink" title="2.3.1 编写工具类"></a>2.3.1 编写工具类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 提示作用域</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SqlSessionFactory sqlSessionFactory;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"><span class="comment">//            使用Mybatis第一步:获取SqlSessionFactory对象</span></span><br><span class="line">            String resource = <span class="string">&quot;mybatis-config.xml&quot;</span>;</span><br><span class="line">            InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">            sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 有了工厂类SqlSessionFactory,就可以获取到SqlSession实例了</span></span><br><span class="line">    <span class="comment">// SqlSession完全包含了面向数据库执行sql命令所需要的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlSession <span class="title">getSqlSession</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sqlSessionFactory.openSession();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-3-1-添加实体类"><a href="#2-3-1-添加实体类" class="headerlink" title="2.3.1 添加实体类"></a>2.3.1 添加实体类</h3><ul>
<li>pojo层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String pwd;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-3-2-编写接口"><a href="#2-3-2-编写接口" class="headerlink" title="2.3.2 编写接口"></a>2.3.2 编写接口</h3><ul>
<li>无需编写实现类，Mybatis会帮我们实现</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">getUserList</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-4-Mapper配置文件"><a href="#2-4-Mapper配置文件" class="headerlink" title="2.4 Mapper配置文件"></a>2.4 Mapper配置文件</h2><ul>
<li>dao层下创建UserMapper.xml文件</li>
<li>注意这个mapper文件需要在mybatis-config进行配置，否则程序运行会因为找不到mapper文件而报错</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="comment">&lt;!DOCTYPE mapper</span></span><br><span class="line"><span class="comment">        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class="line"><span class="comment">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--绑定命名空间,绑定自己的dao层接口--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.kuang.dao.UserDao&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserList&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.kuang.pojo.User&quot;</span>&gt;</span></span><br><span class="line">        select * from mybatis.user;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="2-5-获取结果"><a href="#2-5-获取结果" class="headerlink" title="2.5 获取结果"></a>2.5 获取结果</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">        SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line">        UserDao userDao = sqlSession.getMapper(UserDao.class);</span><br><span class="line"></span><br><span class="line">        List&lt;User&gt; userList = userDao.getUserList();</span><br><span class="line"></span><br><span class="line">        sqlSession.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="三、增删改查"><a href="#三、增删改查" class="headerlink" title="三、增删改查"></a>三、增删改查</h1><h2 id="3-1-namespace"><a href="#3-1-namespace" class="headerlink" title="3.1 namespace"></a>3.1 namespace</h2><ul>
<li>dao层命名统一为xxxMapper.xxx</li>
</ul>
<h2 id="3-2-Mapper配置文件解析"><a href="#3-2-Mapper配置文件解析" class="headerlink" title="3.2 Mapper配置文件解析"></a>3.2 Mapper配置文件解析</h2><ul>
<li>namespace：表示dao层定义的接口路径</li>
<li>id：表示接口中的方法名</li>
<li>resultType：Sql语句执行的返回值类型</li>
<li>parameterType：传入的参数类型</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--绑定命名空间,绑定自己的dao层接口--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.kuang.dao.UserMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserList&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.kuang.pojo.User&quot;</span>&gt;</span></span><br><span class="line">        select * from mybatis.user</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--根据id查询用户--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.kuang.pojo.User&quot;</span>&gt;</span></span><br><span class="line">        select * from mybatis.user where id= #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="3-3-CRUD"><a href="#3-3-CRUD" class="headerlink" title="3.3 CRUD"></a>3.3 CRUD</h2><h3 id="3-3-1-编写sql语句"><a href="#3-3-1-编写sql语句" class="headerlink" title="3.3.1 编写sql语句"></a>3.3.1 编写sql语句</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.kuang.dao.UserMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--根据id查询用户--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.kuang.pojo.User&quot;</span>&gt;</span></span><br><span class="line">        select * from mybatis.user where id= #&#123;id&#125;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--插入用户--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;addUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.kuang.pojo.User&quot;</span>&gt;</span></span><br><span class="line">        insert into mybatis.user(id,name,pwd) values (#&#123;id&#125;,#&#123;name&#125;,#&#123;pwd&#125;);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--修改用户--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.kuang.pojo.User&quot;</span>&gt;</span></span><br><span class="line">        update mybatis.user set name=#&#123;name&#125;,pwd=#&#123;pwd&#125; where id=#&#123;id&#125;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--删除用户--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">        delete from mybatis.user where id = #&#123;id&#125;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="3-3-2-编写接口方法"><a href="#3-3-2-编写接口方法" class="headerlink" title="3.3.2 编写接口方法"></a>3.3.2 编写接口方法</h3><ul>
<li>在接口中定义对应方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">	<span class="comment">// 根据id查找用户</span></span><br><span class="line">    <span class="function">User <span class="title">getUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 插入用户</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">addUser</span><span class="params">(User user)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 修改用户</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">updateUser</span><span class="params">(User user)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 删除用户</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deleteUser</span><span class="params">(User user)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-3-3-测试方法"><a href="#3-3-3-测试方法" class="headerlink" title="3.3.3 测试方法"></a>3.3.3 测试方法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 查询测试</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line"></span><br><span class="line">    UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line"></span><br><span class="line">    User user = userMapper.getUserById(<span class="number">1</span>);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 插入测试</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line"></span><br><span class="line">    UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">    <span class="keyword">int</span> res = userMapper.addUser(<span class="keyword">new</span> User(<span class="number">4</span>,<span class="string">&quot;abc&quot;</span>,<span class="string">&quot;abc&quot;</span>));</span><br><span class="line">    <span class="keyword">if</span>(res &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;插入成功&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 提交事务，否则无法实现插入效果</span></span><br><span class="line">    sqlSession.commit()</span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改测试</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line"></span><br><span class="line">    UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">    userMapper.updateUser(<span class="keyword">new</span> User(<span class="number">3</span>,<span class="string">&quot;abc&quot;</span>,<span class="string">&quot;abc&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 提交事务，否则无法实现插入效果</span></span><br><span class="line">    sqlSession.commit()</span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除测试</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test3</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line"></span><br><span class="line">    UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">    userMapper.deleteUser(<span class="number">1</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 提交事务，否则无法实现插入效果</span></span><br><span class="line">    sqlSession.commit()</span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="四、Map和模糊查询"><a href="#四、Map和模糊查询" class="headerlink" title="四、Map和模糊查询"></a>四、Map和模糊查询</h1><h2 id="4-1-Map实现CRUD"><a href="#4-1-Map实现CRUD" class="headerlink" title="4.1 Map实现CRUD"></a>4.1 Map实现CRUD</h2><h3 id="4-1-1-优势"><a href="#4-1-1-优势" class="headerlink" title="4.1.1 优势"></a>4.1.1 优势</h3><ul>
<li>相对于原来的传pojo对象的方式，map方式更为传参更为灵活</li>
</ul>
<h3 id="4-1-2-编写sql语句"><a href="#4-1-2-编写sql语句" class="headerlink" title="4.1.2 编写sql语句"></a>4.1.2 编写sql语句</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.kuang.dao.UserMapper&quot;</span>&gt;</span> </span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">		插入用户，使用map对象进行插入,注意parameterType=&quot;map&quot;，传递参数为map类型</span></span><br><span class="line"><span class="comment">		values后的字段名可以自定义如userid等，map的键名必须跟这个自定的名字保持一致</span></span><br><span class="line"><span class="comment">            这样就可以在map中取得对应的值，完成数据的插入</span></span><br><span class="line"><span class="comment">		但表的列名字段必须和数据库表保持一致</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;addUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">        insert into mybatis.user(id,name,pwd) values (#&#123;userid&#125;,#&#123;username&#125;,#&#123;password&#125;);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="4-1-3-编写接口方法"><a href="#4-1-3-编写接口方法" class="headerlink" title="4.1.3 编写接口方法"></a>4.1.3 编写接口方法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Map方式插入用户</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">addUser</span><span class="params">(Map&lt;String,Object&gt; map)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-1-4-测试方法"><a href="#4-1-4-测试方法" class="headerlink" title="4.1.4 测试方法"></a>4.1.4 测试方法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line"></span><br><span class="line">    UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line"></span><br><span class="line">    Map&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;String,Object&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;userid&quot;</span>,<span class="number">5</span>);</span><br><span class="line">    map.put(<span class="string">&quot;username&quot;</span>,<span class="string">&quot;123&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;password&quot;</span>,<span class="string">&quot;123&quot;</span>);</span><br><span class="line">    userMapper.addUser(map);</span><br><span class="line">    </span><br><span class="line">    System.out.println(user);</span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="4-2-模糊查询"><a href="#4-2-模糊查询" class="headerlink" title="4.2 模糊查询"></a>4.2 模糊查询</h2><h3 id="4-2-1-编写sql语句"><a href="#4-2-1-编写sql语句" class="headerlink" title="4.2.1 编写sql语句"></a>4.2.1 编写sql语句</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.kuang.dao.UserMapper&quot;</span>&gt;</span> </span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">		写成&quot;%&quot;#&#123;value&#125;&quot;%&quot;形式是为了防止sql注入的风险，推荐，这样只需要传递匹配字符就可以了</span></span><br><span class="line"><span class="comment">		如果写成#&#123;value&#125;就必须传参&quot;%xxx%&quot;,或者其他匹配符，否则报错，但不推荐这么写</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;addUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">        select * from mybatis.user where name like &quot;%&quot;#&#123;value&#125;&quot;%&quot;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="五、环境配置"><a href="#五、环境配置" class="headerlink" title="五、环境配置"></a>五、环境配置</h1><h2 id="5-1-核心配置文件内容"><a href="#5-1-核心配置文件内容" class="headerlink" title="5.1 核心配置文件内容"></a>5.1 核心配置文件内容</h2><ul>
<li>配置标签的位置顺序依次往下，不能随便写在某个位置，否则会报错</li>
<li>properties（属性）</li>
<li>setting（设置）</li>
<li>typeAliases（类型别名）</li>
<li>typeHandlers（类型处理器）</li>
<li>objectFactory（对象工厂）</li>
<li>plugins（插件）</li>
<li>environments（环境配置）<ul>
<li>environment（环境变量）<ul>
<li>transactionManager（事务管理器）</li>
<li>dataSource（数据源）</li>
</ul>
</li>
</ul>
</li>
<li>databaseldProvider（数据库厂商标识）</li>
<li>mappers（映射器）</li>
</ul>
<h2 id="5-2-properties（属性）"><a href="#5-2-properties（属性）" class="headerlink" title="5.2 properties（属性）"></a>5.2 properties（属性）</h2><ul>
<li>新建properties配置文件</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">driver</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/mybatis?useSSL=true&amp;useUnicode=true&amp;characterEncoding=UTF-8</span></span><br><span class="line"><span class="attr">username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">FLzxSQC1998.Com</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>在核心配置文件中引入外部配置文件，如db.properties<ul>
<li>需要注意的是，这个properties标签需要写在configuration标签下的第一个位置，因为configuration中的标签有顺序要求，否则会报错</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--也可以在properties中配置对应的属性，但默认会先从外部的配置文件开始读取--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--内部配置属性</span></span><br><span class="line"><span class="comment">&lt;properties resource=&quot;db.properties&quot;&gt;</span></span><br><span class="line"><span class="comment">  &lt;property name=&quot;username&quot; value=&quot;dev_user&quot;/&gt;</span></span><br><span class="line"><span class="comment">  &lt;property name=&quot;password&quot; value=&quot;F2Fa3!33TYyg&quot;/&gt;</span></span><br><span class="line"><span class="comment">&lt;/properties&gt;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;db.properties&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--配置时，使用$&#123;&#125;取到properties配置文件中对应的值--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;url&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;username&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;password&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="5-3-typeAliases（类型别名）"><a href="#5-3-typeAliases（类型别名）" class="headerlink" title="5.3 typeAliases（类型别名）"></a>5.3 typeAliases（类型别名）</h2><h3 id="5-3-1-自定义别名"><a href="#5-3-1-自定义别名" class="headerlink" title="5.3.1 自定义别名"></a>5.3.1 自定义别名</h3><ul>
<li>类型别名可为 Java 类型设置一个缩写名字。 它仅用于 XML 配置，意在降低冗余的全限定类名书写。</li>
<li>设置完简化后的别命，在使用时可以直接使用，比如在sql语句配置文件的returnType就可以直接使用别名，使配置更加简洁清晰</li>
<li>当这样配置时，<strong>别名</strong>可以用在任何使用<strong>它</strong>的地方，<strong>这种方式一般在实体类较少的情况下使用</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">alias</span>=<span class="string">&quot;Author&quot;</span> <span class="attr">type</span>=<span class="string">&quot;domain.blog.Author&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">alias</span>=<span class="string">&quot;Blog&quot;</span> <span class="attr">type</span>=<span class="string">&quot;domain.blog.Blog&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">alias</span>=<span class="string">&quot;Comment&quot;</span> <span class="attr">type</span>=<span class="string">&quot;domain.blog.Comment&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">alias</span>=<span class="string">&quot;Post&quot;</span> <span class="attr">type</span>=<span class="string">&quot;domain.blog.Post&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">alias</span>=<span class="string">&quot;Section&quot;</span> <span class="attr">type</span>=<span class="string">&quot;domain.blog.Section&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">alias</span>=<span class="string">&quot;Tag&quot;</span> <span class="attr">type</span>=<span class="string">&quot;domain.blog.Tag&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="5-3-2-扫描包生成别名"><a href="#5-3-2-扫描包生成别名" class="headerlink" title="5.3.2 扫描包生成别名"></a>5.3.2 扫描包生成别名</h3><ul>
<li>也可以指定一个包名，MyBatis 会在包名下面搜索需要的 Java Bean</li>
<li>这种可以在实体类比较多的时候使用</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">	设置包后，会自动为对应的类设置别命，别名即为类名</span></span><br><span class="line"><span class="comment">	这种情况，设置的别名为首字母小写的类名，比如domain.blog.Author 的别名为 author</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;domain.blog&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="5-3-3-注解别名"><a href="#5-3-3-注解别名" class="headerlink" title="5.3.3 注解别名"></a>5.3.3 注解别名</h3><ul>
<li>还可以使用注解设置别名</li>
<li>在使用<strong>扫描包生成别名</strong>时，如果非要改成自定义的，可以在对应类上加上注解</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Alias(&quot;author&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Author</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5-3-4-基本类型的别名"><a href="#5-3-4-基本类型的别名" class="headerlink" title="5.3.4 基本类型的别名"></a>5.3.4 基本类型的别名</h3><ul>
<li>基本类型前加下划线：如int别名：_int</li>
<li>包装类型首字母小写：如Integer别名：int</li>
</ul>
<h2 id="5-4-setting（设置）"><a href="#5-4-setting（设置）" class="headerlink" title="5.4 setting（设置）"></a>5.4 setting（设置）</h2><h2 id="5-5-其他配置"><a href="#5-5-其他配置" class="headerlink" title="5.5 其他配置"></a>5.5 其他配置</h2><h2 id="5-6-mappers（映射器）"><a href="#5-6-mappers（映射器）" class="headerlink" title="5.6 mappers（映射器）"></a>5.6 mappers（映射器）</h2><ul>
<li>在核心配置文件中配置mapper配置文件所在路径</li>
<li>方式一：使用mapper文件绑定【推荐】</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用相对于类路径的资源引用 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;org/mybatis/builder/AuthorMapper.xml&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;org/mybatis/builder/BlogMapper.xml&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;org/mybatis/builder/PostMapper.xml&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>方式二：使用class绑定</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用映射器接口实现类的完全限定类名 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.builder.AuthorMapper&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.builder.BlogMapper&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.builder.PostMapper&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>使用除方式一外的其他方式时的注意点：<ul>
<li>接口和他的Mapper配置文件必须同名</li>
<li>接口和他的Mapper配置文件必须在同一包下</li>
</ul>
</li>
</ul>
<h1 id="六、生命周期和作用域"><a href="#六、生命周期和作用域" class="headerlink" title="六、生命周期和作用域"></a>六、生命周期和作用域</h1><h2 id="6-1-SqlSessionFactoryBuilder"><a href="#6-1-SqlSessionFactoryBuilder" class="headerlink" title="6.1 SqlSessionFactoryBuilder"></a>6.1 SqlSessionFactoryBuilder</h2><ul>
<li>这个类可以被实例化、使用和丢弃，一旦创建了 SqlSessionFactory，就不再需要它了</li>
</ul>
<h2 id="6-2-SqlSessionFactory"><a href="#6-2-SqlSessionFactory" class="headerlink" title="6.2 SqlSessionFactory"></a>6.2 SqlSessionFactory</h2><ul>
<li>SqlSessionFactory 一旦被创建就应该在应用的运行期间一直存在，没有任何理由丢弃它或重新创建另一个实例</li>
<li>类似数据库连接池</li>
</ul>
<h2 id="6-3-SqlSession"><a href="#6-3-SqlSession" class="headerlink" title="6.3 SqlSession"></a>6.3 SqlSession</h2><ul>
<li>每个线程都应该有它自己的 SqlSession 实例。SqlSession 的实例不是线程安全的，因此是不能被共享的，所以它的最佳的作用域是请求或方法作用域</li>
<li>连接到连接池的一个请求</li>
<li>绝对不能将 SqlSession 实例的引用放在一个类的静态域，甚至一个类的实例变量也不行。 也绝不能将 SqlSession 实例的引用放在任何类型的托管作用域中</li>
<li>每次收到 HTTP 请求，就可以打开一个 SqlSession，返回一个响应后，就关闭它</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> (SqlSession session = sqlSessionFactory.openSession()) &#123;</span><br><span class="line">  <span class="comment">// 你的应用逻辑代码</span></span><br><span class="line">&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">    session.close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="6-4-获取映射实例"><a href="#6-4-获取映射实例" class="headerlink" title="6.4 获取映射实例"></a>6.4 获取映射实例</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> (SqlSession session = sqlSessionFactory.openSession()) &#123;</span><br><span class="line">  BlogMapper mapper = session.getMapper(BlogMapper.class);</span><br><span class="line">  <span class="comment">// 你的应用逻辑代码</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<img src="/2022/03/14/Mybatis%E5%9F%BA%E7%A1%80%E5%A4%A7%E5%85%A8/life.png" class="" title="life">
<h1 id="七、ResultMap结果集映射"><a href="#七、ResultMap结果集映射" class="headerlink" title="七、ResultMap结果集映射"></a>七、ResultMap结果集映射</h1><h2 id="7-1-简介"><a href="#7-1-简介" class="headerlink" title="7.1 简介"></a>7.1 简介</h2><ul>
<li>解决实体类属性名和数据库表字段名不一致的问题</li>
</ul>
<h2 id="7-2-结果映射"><a href="#7-2-结果映射" class="headerlink" title="7.2 结果映射"></a>7.2 结果映射</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">	结果映射标签</span></span><br><span class="line"><span class="comment">	property对应了实体类属性，column对应表字段</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;userResultMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;user_id&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;username&quot;</span> <span class="attr">column</span>=<span class="string">&quot;user_name&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;password&quot;</span> <span class="attr">column</span>=<span class="string">&quot;hashed_password&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--这里的返回类型使用resultMap标注，值为resultMap标签的id--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUsers&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;userResultMap&quot;</span>&gt;</span></span><br><span class="line">  select user_id, user_name, hashed_password</span><br><span class="line">  from some_table</span><br><span class="line">  where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="八、日志"><a href="#八、日志" class="headerlink" title="八、日志"></a>八、日志</h1><h2 id="8-1-日志工厂"><a href="#8-1-日志工厂" class="headerlink" title="8.1 日志工厂"></a>8.1 日志工厂</h2><ul>
<li>如果一个数据库操作出现了异常，我们最好是能看到操作的sql语句是啥，方便我们排错</li>
<li>因此针对以上问题，我们可以使用日志的形式输出我们数据库操作的sql语句</li>
<li>Mybatis 通过使用内置的日志工厂提供日志功能。内置日志工厂将会把日志工作委托给下面的实现之一：<ul>
<li>SLF4J</li>
<li>LOG4J【掌握】</li>
<li>LOG4J2</li>
<li>JDK_LOGGING</li>
<li>COMMONS_LOGGING</li>
<li>STDOUT_LOGGING【掌握】</li>
<li>NO_LOGGING</li>
</ul>
</li>
</ul>
<h2 id="8-2-日志配置"><a href="#8-2-日志配置" class="headerlink" title="8.2 日志配置"></a>8.2 日志配置</h2><ul>
<li>需要在核心配置文件中进行配置</li>
<li>配置完后直接运行即可，就可以在控制台输出日志信息</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;logImpl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;STDOUT_LOGGING&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="8-3-Log4j"><a href="#8-3-Log4j" class="headerlink" title="8.3 Log4j"></a>8.3 Log4j</h2><h3 id="8-3-1-核心配置"><a href="#8-3-1-核心配置" class="headerlink" title="8.3.1 核心配置"></a>8.3.1 核心配置</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;logImpl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;LOG4J&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="8-3-2-导入Log4j"><a href="#8-3-2-导入Log4j" class="headerlink" title="8.3.2 导入Log4j"></a>8.3.2 导入Log4j</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/log4j/log4j --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="8-3-3-log4j配置文件"><a href="#8-3-3-log4j配置文件" class="headerlink" title="8.3.3 log4j配置文件"></a>8.3.3 log4j配置文件</h3><ul>
<li>在resources下创建log4j.properties配置文件</li>
<li>这里面可以配置许多日志的输出格式</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### 设置###</span></span><br><span class="line"><span class="meta">log4j.rootLogger</span> = <span class="string">debug,stdout,D,E</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">### 输出信息到控制抬 ###</span></span><br><span class="line"><span class="meta">log4j.appender.stdout</span> = <span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="meta">log4j.appender.stdout.Target</span> = <span class="string">System.out</span></span><br><span class="line"><span class="meta">log4j.appender.stdout.layout</span> = <span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.stdout.layout.ConversionPattern</span> = <span class="string">[%-5p] %d&#123;yyyy-MM-dd HH:mm:ss,SSS&#125; method:%l%n%m%n</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">### 输出DEBUG 级别以上的日志到=E://logs/error.log ###</span></span><br><span class="line"><span class="meta">log4j.appender.D</span> = <span class="string">org.apache.log4j.DailyRollingFileAppender</span></span><br><span class="line"><span class="meta">log4j.appender.D.File</span> = <span class="string">E://logs/log.log</span></span><br><span class="line"><span class="meta">log4j.appender.D.Append</span> = <span class="string">true</span></span><br><span class="line"><span class="meta">log4j.appender.D.Threshold</span> = <span class="string">DEBUG </span></span><br><span class="line"><span class="meta">log4j.appender.D.layout</span> = <span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.D.layout.ConversionPattern</span> = <span class="string">%-d&#123;yyyy-MM-dd HH:mm:ss&#125;  [ %t:%r ] - [ %p ]  %m%n</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">### 输出ERROR 级别以上的日志到=E://logs/error.log ###</span></span><br><span class="line"><span class="meta">log4j.appender.E</span> = <span class="string">org.apache.log4j.DailyRollingFileAppender</span></span><br><span class="line"><span class="meta">log4j.appender.E.File</span> =<span class="string">E://logs/error.log </span></span><br><span class="line"><span class="meta">log4j.appender.E.Append</span> = <span class="string">true</span></span><br><span class="line"><span class="meta">log4j.appender.E.Threshold</span> = <span class="string">ERROR </span></span><br><span class="line"><span class="meta">log4j.appender.E.layout</span> = <span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.E.layout.ConversionPattern</span> = <span class="string">%-d&#123;yyyy-MM-dd HH:mm:ss&#125;  [ %t:%r ] - [ %p ]  %m%n</span></span><br></pre></td></tr></table></figure>
<h3 id="8-3-4-Log4j的使用"><a href="#8-3-4-Log4j的使用" class="headerlink" title="8.3.4 Log4j的使用"></a>8.3.4 Log4j的使用</h3><ul>
<li><p>直接运行就可以在控制台输出日志</p>
</li>
<li><p>也可以编写语句</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoTest</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 生成logger对象</span></span><br><span class="line">    <span class="keyword">static</span> Logger logger = Logger.getLogger(String.valueOf(UserDaoTest.class));</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testLog4j</span><span class="params">()</span></span>&#123;</span><br><span class="line">        logger.info(<span class="string">&quot;info：进入了testLog4j&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="九、分页实现"><a href="#九、分页实现" class="headerlink" title="九、分页实现"></a>九、分页实现</h1><h2 id="9-1-Limit分页"><a href="#9-1-Limit分页" class="headerlink" title="9.1 Limit分页"></a>9.1 Limit分页</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="keyword">user</span> LIMIT startIndex,pageSize;</span><br></pre></td></tr></table></figure>
<h2 id="9-2-Mybatis分页"><a href="#9-2-Mybatis分页" class="headerlink" title="9.2 Mybatis分页"></a>9.2 Mybatis分页</h2><h3 id="9-2-1-定义接口方法"><a href="#9-2-1-定义接口方法" class="headerlink" title="9.2.1 定义接口方法"></a>9.2.1 定义接口方法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">getUserByLimit</span><span class="params">(Map&lt;String,Integer&gt; map)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="9-2-1-mapper配置文件"><a href="#9-2-1-mapper配置文件" class="headerlink" title="9.2.1 mapper配置文件"></a>9.2.1 mapper配置文件</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserByLimit&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.kuang.pojo.User&quot;</span>&gt;</span></span><br><span class="line">    select * from mybatis.user limit #&#123;startIndex&#125;,#&#123;pageSize&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="9-2-3-测试"><a href="#9-2-3-测试" class="headerlink" title="9.2.3 测试"></a>9.2.3 测试</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test4</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line">    UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line"></span><br><span class="line">    Map&lt;String,Integer&gt; map = <span class="keyword">new</span> HashMap&lt;String, Integer&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;startIndex&quot;</span>,<span class="number">0</span>);</span><br><span class="line">    map.put(<span class="string">&quot;pageSize&quot;</span>,<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    List&lt;User&gt; users = userMapper.getUserByLimit(map);</span><br><span class="line">    <span class="keyword">for</span> (User user : users)&#123;</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="十、注解开发"><a href="#十、注解开发" class="headerlink" title="十、注解开发"></a>十、注解开发</h1><ul>
<li>使用注解来映射简单语句会使代码显得更加简洁，但对于稍微复杂一点的语句，Java 注解不仅力不从心</li>
<li>本质：反射机制</li>
<li>底层：动态代理</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span></span>&#123;</span><br><span class="line">    <span class="meta">@Select(&quot;select * from user&quot;)</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">getUsers</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="十一、Mybatis执行流程"><a href="#十一、Mybatis执行流程" class="headerlink" title="十一、Mybatis执行流程"></a>十一、Mybatis执行流程</h1><h1 id="十二、Lombok"><a href="#十二、Lombok" class="headerlink" title="十二、Lombok"></a>十二、Lombok</h1><h1 id="十三、复杂查询处理"><a href="#十三、复杂查询处理" class="headerlink" title="十三、复杂查询处理"></a>十三、复杂查询处理</h1><h2 id="13-1-数据库环境"><a href="#13-1-数据库环境" class="headerlink" title="13.1 数据库环境"></a>13.1 数据库环境</h2><ul>
<li>学生表：id、name、tid（外键）</li>
<li>教师表：id、name</li>
<li>一个教师教多个学生：一对多</li>
<li>多个学习选同一个老师：多对一</li>
<li>学生类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Teacher teacher;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>教师类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Teacher</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Student&gt; students;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="13-1-多对一处理"><a href="#13-1-多对一处理" class="headerlink" title="13.1 多对一处理"></a>13.1 多对一处理</h2><h3 id="13-1-1-方式一：查询嵌套"><a href="#13-1-1-方式一：查询嵌套" class="headerlink" title="13.1.1 方式一：查询嵌套"></a>13.1.1 方式一：查询嵌套</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--绑定命名空间,绑定自己的dao层接口--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.kuang.dao.StudentMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getStudents&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;StudentTeacher&quot;</span>&gt;</span></span><br><span class="line">        select * from student;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;StudentTeacher&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.kuang.pojo.Student&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">column</span>=<span class="string">&quot;tid&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;com.kuang.pojo.Teacher&quot;</span> <span class="attr">select</span>=<span class="string">&quot;getTeacher&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getTeacher&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.kuang.pojo.Teacher&quot;</span>&gt;</span></span><br><span class="line">        select * from teacher where id = #&#123;tid&#125;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="13-1-2-方式二：结果嵌套"><a href="#13-1-2-方式二：结果嵌套" class="headerlink" title="13.1.2 方式二：结果嵌套"></a>13.1.2 方式二：结果嵌套</h3><ul>
<li>连表查询，不想方式二分成两个查询语句</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.kuang.dao.StudentMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getStudents&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;StudentTeacher&quot;</span>&gt;</span></span><br><span class="line">        select s.id sid,s.name sname,t.name tname</span><br><span class="line">        from student s,teacher t</span><br><span class="line">        where s.tid = t.id;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--这里的column应该是上面select语句定义的别名--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;StudentTeacher&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.kuang.pojo.Student&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sid&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sname&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;com.kuang.pojo.Teacher&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;tname&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="13-1-3-结果"><a href="#13-1-3-结果" class="headerlink" title="13.1.3 结果"></a>13.1.3 结果</h3><ul>
<li>以上两种方式的结果输出相同</li>
</ul>
<img src="/2022/03/14/Mybatis%E5%9F%BA%E7%A1%80%E5%A4%A7%E5%85%A8/student.png" class="" title="stu">
<h2 id="13-2-一对多处理"><a href="#13-2-一对多处理" class="headerlink" title="13.2 一对多处理"></a>13.2 一对多处理</h2><h3 id="13-2-1-方式一：查询嵌套"><a href="#13-2-1-方式一：查询嵌套" class="headerlink" title="13.2.1 方式一：查询嵌套"></a>13.2.1 方式一：查询嵌套</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.kuang.dao.TeacherMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getTeacher&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;TeacherStudent&quot;</span>&gt;</span></span><br><span class="line">        select s.id sid,s.name sname,t.name tname,t.id tid</span><br><span class="line">        from student s,teacher t</span><br><span class="line">        where s.tid = t.id and t.id = #&#123;tid&#125;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;TeacherStudent&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.kuang.pojo.Teacher&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;tid&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;tname&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;students&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;com.kuang.pojo.Student&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sid&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sname&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;tid&quot;</span> <span class="attr">column</span>=<span class="string">&quot;tid&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="13-2-2-方式二：结果嵌套"><a href="#13-2-2-方式二：结果嵌套" class="headerlink" title="13.2.2 方式二：结果嵌套"></a>13.2.2 方式二：结果嵌套</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.kuang.dao.TeacherMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getTeacher&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;TeacherStudent&quot;</span>&gt;</span></span><br><span class="line">        select * from teacher where id = #&#123;tid&#125;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;TeacherStudent&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.kuang.pojo.Teacher&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;students&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;ArrayList&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;Student&quot;</span> <span class="attr">select</span>=<span class="string">&quot;getStudents&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getStudents&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.kuang.pojo.Student&quot;</span>&gt;</span></span><br><span class="line">        select * from student where tid = #&#123;id&#125;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="13-2-3-结果"><a href="#13-2-3-结果" class="headerlink" title="13.2.3 结果"></a>13.2.3 结果</h3><ul>
<li>以上两种方式结果相同</li>
</ul>
<img src="/2022/03/14/Mybatis%E5%9F%BA%E7%A1%80%E5%A4%A7%E5%85%A8/teacher.png" class="" title="tea">
<h2 id="13-3-小结"><a href="#13-3-小结" class="headerlink" title="13.3 小结"></a>13.3 小结</h2><ul>
<li>多对一：association（关联）</li>
<li>一对多：collection（集合），和上面都是在returnMap结果映射中使用</li>
<li>javaType：指定实体类中属性的类型</li>
<li>ofType：指定映射到List或集合中的pojo类型，泛型中约束的类型（一般在collection中会使用到）</li>
<li>在没有为pojo类起别名时，returnType直接使用类名会报错ClassNotFound，此时必须包的全类名</li>
<li>colume属性对应的是select语句指定的导出表的列名，如果有列的别名，就写别名</li>
<li>以上两种方式都可实现效果，视情况而定实现方式</li>
</ul>
<h1 id="十四、动态Sql"><a href="#十四、动态Sql" class="headerlink" title="十四、动态Sql"></a>十四、动态Sql</h1><h2 id="14-1-简介"><a href="#14-1-简介" class="headerlink" title="14.1 简介"></a>14.1 简介</h2><ul>
<li>对sql语句添加条件判断，根据条件判断生成不同的sql语句</li>
</ul>
<h2 id="14-2-动态sql标签"><a href="#14-2-动态sql标签" class="headerlink" title="14.2 动态sql标签"></a>14.2 动态sql标签</h2><ul>
<li>if</li>
<li>choose (when, otherwise)</li>
<li>trim (where, set)</li>
<li>foreach</li>
<li>sql</li>
</ul>
<h2 id="14-3-if"><a href="#14-3-if" class="headerlink" title="14.3 if"></a>14.3 if</h2><ul>
<li>if表示如果查询的map中存在这个字段，就拼接if中的语句，否则不进行拼接</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findActiveBlogWithTitleLike&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span></span></span><br><span class="line"><span class="tag">     <span class="attr">resultType</span>=<span class="string">&quot;Blog&quot;</span>&gt;</span></span><br><span class="line">  SELECT * FROM BLOG</span><br><span class="line">  WHERE state = ‘ACTIVE’</span><br><span class="line">  <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;title != null&quot;</span>&gt;</span></span><br><span class="line">    AND title like #&#123;title&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>这种语句会存在一种缺陷，它只是机械的语句拼接</p>
</li>
<li><p>下面这种情况就可能拼接出：SELECT <em> FROM BLOG WHERE AND title like #{title}或者SELECT </em> FROM BLOG WHERE</p>
<ul>
<li>这就造成了sql语句的语法错误，无法完成查询，需要用到下面的where标签</li>
<li>where标签可以自动的去除一些字段，比如多余的AND或者符号“，”</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findActiveBlogLike&quot;</span></span></span><br><span class="line"><span class="tag">     <span class="attr">resultType</span>=<span class="string">&quot;Blog&quot;</span>&gt;</span></span><br><span class="line">  SELECT * FROM BLOG</span><br><span class="line">  WHERE</span><br><span class="line">  <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;state != null&quot;</span>&gt;</span></span><br><span class="line">    state = #&#123;state&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;title != null&quot;</span>&gt;</span></span><br><span class="line">    AND title like #&#123;title&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;author != null and author.name != null&quot;</span>&gt;</span></span><br><span class="line">    AND author_name like #&#123;author.name&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="14-4-choose"><a href="#14-4-choose" class="headerlink" title="14.4 choose"></a>14.4 choose</h2><ul>
<li>choose类似于java中的switch，选择语句，满足其中一条则拼接对应的语句</li>
<li>如果都不满足则拼接otherwise中的语句</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findActiveBlogLike&quot;</span></span></span><br><span class="line"><span class="tag">     <span class="attr">resultType</span>=<span class="string">&quot;Blog&quot;</span>&gt;</span></span><br><span class="line">  SELECT * FROM BLOG WHERE state = ‘ACTIVE’</span><br><span class="line">  <span class="tag">&lt;<span class="name">choose</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;title != null&quot;</span>&gt;</span></span><br><span class="line">      AND title like #&#123;title&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;author != null and author.name != null&quot;</span>&gt;</span></span><br><span class="line">      AND author_name like #&#123;author.name&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">otherwise</span>&gt;</span></span><br><span class="line">      AND featured = 1</span><br><span class="line">    <span class="tag">&lt;/<span class="name">otherwise</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="14-5-trim（where、set）"><a href="#14-5-trim（where、set）" class="headerlink" title="14.5 trim（where、set）"></a>14.5 trim（where、set）</h2><h3 id="14-5-1-where"><a href="#14-5-1-where" class="headerlink" title="14.5.1 where"></a>14.5.1 where</h3><ul>
<li>将所有匹配条件放入到where标签中</li>
<li>解决了if标签的机械的语句拼接问题</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findActiveBlogLike&quot;</span></span></span><br><span class="line"><span class="tag">     <span class="attr">resultType</span>=<span class="string">&quot;Blog&quot;</span>&gt;</span></span><br><span class="line">  SELECT * FROM BLOG</span><br><span class="line">  <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;state != null&quot;</span>&gt;</span></span><br><span class="line">         state = #&#123;state&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;title != null&quot;</span>&gt;</span></span><br><span class="line">        AND title like #&#123;title&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;author != null and author.name != null&quot;</span>&gt;</span></span><br><span class="line">        AND author_name like #&#123;author.name&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="14-5-2-set"><a href="#14-5-2-set" class="headerlink" title="14.5.2 set"></a>14.5.2 set</h3><ul>
<li>完成update的操作标签</li>
<li>也是用if进行条件判断拼接sql语句</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateAuthorIfNecessary&quot;</span>&gt;</span></span><br><span class="line">  update Author</span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;username != null&quot;</span>&gt;</span>username=#&#123;username&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;password != null&quot;</span>&gt;</span>password=#&#123;password&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;email != null&quot;</span>&gt;</span>email=#&#123;email&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;bio != null&quot;</span>&gt;</span>bio=#&#123;bio&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">  where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="14-5-3-trim"><a href="#14-5-3-trim" class="headerlink" title="14.5.3 trim"></a>14.5.3 trim</h2><ul>
<li>trim可以完成一些自定义的操作</li>
<li>比如自定where和set标签，意思就是trim可以替换where和set标签</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">&quot;WHERE&quot;</span> <span class="attr">prefixOverrides</span>=<span class="string">&quot;AND |OR &quot;</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">&quot;SET&quot;</span> <span class="attr">suffixOverrides</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="14-6-foreach"><a href="#14-6-foreach" class="headerlink" title="14.6 foreach"></a>14.6 foreach</h2><ul>
<li>这里是从POST表中查询需要的多条数据</li>
<li>这里的collection指定的是我们传入的列表，这里返回的就是列表中指定的id对应的数据</li>
<li>加入说list中的id列表为(1,2,3)，那么就将满足这些id的数据全部获取到：(id=1,name=…)、(id=2,name=…)、(id=3,name=…)</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectPostIn&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;domain.blog.Post&quot;</span>&gt;</span></span><br><span class="line">  SELECT *</span><br><span class="line">  FROM POST P</span><br><span class="line">  <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">item</span>=<span class="string">&quot;item&quot;</span> <span class="attr">index</span>=<span class="string">&quot;index&quot;</span> <span class="attr">collection</span>=<span class="string">&quot;list&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">open</span>=<span class="string">&quot;ID in (&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span> <span class="attr">nullable</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">          #&#123;item&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="14-7-sql"><a href="#14-7-sql" class="headerlink" title="14.7 sql"></a>14.7 sql</h2><ul>
<li>用于封装动态sql语句</li>
<li>使用include标签引入外部sql标签的id</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">&quot;if-title-author&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;state != null&quot;</span>&gt;</span></span><br><span class="line">        state = #&#123;state&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;title != null&quot;</span>&gt;</span></span><br><span class="line">        AND title like #&#123;title&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;author != null and author.name != null&quot;</span>&gt;</span></span><br><span class="line">        AND author_name like #&#123;author.name&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findActiveBlogLike&quot;</span></span></span><br><span class="line"><span class="tag">     <span class="attr">resultType</span>=<span class="string">&quot;Blog&quot;</span>&gt;</span></span><br><span class="line">  SELECT * FROM BLOG</span><br><span class="line">  <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;if-title-author&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="十五、缓存"><a href="#十五、缓存" class="headerlink" title="十五、缓存"></a>十五、缓存</h1><h2 id="15-1-缓存介绍"><a href="#15-1-缓存介绍" class="headerlink" title="15.1 缓存介绍"></a>15.1 缓存介绍</h2><ul>
<li>多次重复查询会消耗服务器连接数据库的资源</li>
<li>缓存：存放一次查询的结果，下次查询就不用查数据库了</li>
<li>使用缓存的情况：经常查询且不经常改变的数据</li>
</ul>
<h2 id="15-2-一级缓存"><a href="#15-2-一级缓存" class="headerlink" title="15.2 一级缓存"></a>15.2 一级缓存</h2><h3 id="15-2-1-简介"><a href="#15-2-1-简介" class="headerlink" title="15.2.1 简介"></a>15.2.1 简介</h3><ul>
<li>一级缓存是默认开启的</li>
<li>只在一次SqlSession中有效，也就是SqlSession打开到关闭之间，进行查询就会存在缓存，下次查询相同数据就不会再执行一次sql语句，直接从缓存中抽取数据</li>
</ul>
<h3 id="15-2-2-缓存失效的情况"><a href="#15-2-2-缓存失效的情况" class="headerlink" title="15.2.2 缓存失效的情况"></a>15.2.2 缓存失效的情况</h3><ul>
<li>查询不同的内容</li>
<li>增删改操作会改变原来的数据，所以必定会刷新缓存</li>
<li>查询不同的Mapper.xml</li>
<li>手动清理缓存</li>
</ul>
<h2 id="15-3-二级缓存"><a href="#15-3-二级缓存" class="headerlink" title="15.3 二级缓存"></a>15.3 二级缓存</h2><h3 id="15-3-1-简介"><a href="#15-3-1-简介" class="headerlink" title="15.3.1 简介"></a>15.3.1 简介</h3><ul>
<li>二级缓存也叫全局缓存，这是由于一级缓存的作用域太低，所以诞生了二级缓存</li>
<li>基于namespace级别的缓存，一个名称空间对应一个二级缓存</li>
<li>工作机制<ul>
<li>一个会话查询一条数据，这个数据就会被放在当前会话的一级缓存中</li>
<li>如果当前会话关闭了，这个会话对应的一级缓存就没有了，现在需要的是，会话关闭时，一级缓存的数据可以保存到二级缓存中</li>
<li>新的会话查询，就可以从二级缓存中获取内容</li>
<li>不同的mapper查出的数据会放在自己对应的缓存（map）中</li>
</ul>
</li>
</ul>
<h3 id="15-3-2-开启二级缓存"><a href="#15-3-2-开启二级缓存" class="headerlink" title="15.3.2 开启二级缓存"></a>15.3.2 开启二级缓存</h3><ul>
<li>在核心配置文件添加以下标签，开启全局缓存</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--显示开启全局缓存，默认是开启的--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;cacheEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">setting</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>配置完后还需要再需要使用二级缓存的Mapper配置文件下添加cache标签<ul>
<li>eviction为缓存策略</li>
<li>flushInterval为缓存刷新时间</li>
<li>size为最大数引用数</li>
<li>readOnly为是否只读</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;xxx&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--在当前mapper下开启二级缓存--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">cache</span></span></span><br><span class="line"><span class="tag">      <span class="attr">eviction</span>=<span class="string">&quot;FIFO&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">flushInterval</span>=<span class="string">&quot;60000&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">size</span>=<span class="string">&quot;512&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">readOnly</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--也可以直接使用cache标签--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">cache</span>/&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">useCache</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">    	...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>使用cache标签，不添加缓存策略时，需要将实体类实现序列化，如下</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="15-3-3-小结"><a href="#15-3-3-小结" class="headerlink" title="15.3.3 小结"></a>15.3.3 小结</h3><ul>
<li>只要开启了二级缓存，在同一个Mapper下就有效</li>
<li>所有的数据都会先放在一级缓存中<ul>
<li>只有当会话提交，或者关闭的时候，才会提交到二级缓存中</li>
</ul>
</li>
</ul>
<h2 id="15-4-缓存原理"><a href="#15-4-缓存原理" class="headerlink" title="15.4 缓存原理"></a>15.4 缓存原理</h2><ul>
<li>每个SqlSession从开启到关闭都会启动一个一级缓存</li>
<li>SqlSession关闭后一级缓存会升级为二级缓存</li>
<li>用户进行查询时会先看二级缓存是否存在查询的内容，再去一级缓存，缓存中没有要查找的对象时，就执行查询数据库的操作</li>
</ul>
<img src="/2022/03/14/Mybatis%E5%9F%BA%E7%A1%80%E5%A4%A7%E5%85%A8/cache.png" class="" title="cache">
<h2 id="15-5-自定义缓存"><a href="#15-5-自定义缓存" class="headerlink" title="15.5 自定义缓存"></a>15.5 自定义缓存</h2><h3 id="15-5-1-ehcache"><a href="#15-5-1-ehcache" class="headerlink" title="15.5.1 ehcache"></a>15.5.1 ehcache</h3><ul>
<li>EhCache 是一个纯Java的进程内缓存框架，具有快速、精干等特点，是Hibernate中默认的CacheProvider。</li>
</ul>
<h3 id="15-5-2-引入依赖"><a href="#15-5-2-引入依赖" class="headerlink" title="15.5.2 引入依赖"></a>15.5.2 引入依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.mybatis.caches/mybatis-ehcache --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.caches<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-ehcache<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="15-5-3-cache配置"><a href="#15-5-3-cache配置" class="headerlink" title="15.5.3 cache配置"></a>15.5.3 cache配置</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;xxx&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">cache</span> <span class="attr">type</span>=<span class="string">&quot;org.mybatis.caches.ehcache.EhcacheCache&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="15-5-4-ehcache配置文件"><a href="#15-5-4-ehcache配置文件" class="headerlink" title="15.5.4 ehcache配置文件"></a>15.5.4 ehcache配置文件</h3>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://cnovelist.github.io/2022/03/12/%E5%89%8D%E7%AB%AF%E7%BB%84%E4%BB%B6%E5%AE%9E%E7%8E%B0-%E5%9F%BA%E4%BA%8Evis-js%E7%9A%84%E8%8A%82%E7%82%B9%E5%B1%95%E5%BC%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/yue.jpeg">
      <meta itemprop="name" content="故事开头">
      <meta itemprop="description" content="一个穷鬼">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="江小月不上頭">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/03/12/%E5%89%8D%E7%AB%AF%E7%BB%84%E4%BB%B6%E5%AE%9E%E7%8E%B0-%E5%9F%BA%E4%BA%8Evis-js%E7%9A%84%E8%8A%82%E7%82%B9%E5%B1%95%E5%BC%80/" class="post-title-link" itemprop="url">前端组件实现-基于vis.js的节点展开</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-03-12 22:41:46" itemprop="dateCreated datePublished" datetime="2022-03-12T22:41:46+08:00">2022-03-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-03-13 17:08:47" itemprop="dateModified" datetime="2022-03-13T17:08:47+08:00">2022-03-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%89%8D%E7%AB%AF/JavaScript/" itemprop="url" rel="index"><span itemprop="name">JavaScript</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="一、数据准备"><a href="#一、数据准备" class="headerlink" title="一、数据准备"></a>一、数据准备</h1><h2 id="1-1-概述"><a href="#1-1-概述" class="headerlink" title="1.1 概述"></a>1.1 概述</h2><ul>
<li>id最好设置为数值型，方便后面的查找工作，需要通过id值查找其在staticNodes中的下标值</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置点和边的数据</span></span><br><span class="line"><span class="keyword">var</span> staticNodes = [</span><br><span class="line">    &#123;<span class="attr">id</span>:<span class="number">1</span>, <span class="attr">label</span>:<span class="string">&quot;高玥&quot;</span>, <span class="attr">group</span>:<span class="number">1</span>, <span class="attr">pid</span>:<span class="number">0</span>, <span class="attr">subids</span>:[<span class="number">2</span>,<span class="number">3</span>]&#125;,</span><br><span class="line">    &#123;<span class="attr">id</span>:<span class="number">2</span>, <span class="attr">label</span>:<span class="string">&quot;篮球&quot;</span>, <span class="attr">group</span>:<span class="number">2</span>, <span class="attr">pid</span>:<span class="number">1</span>, <span class="attr">subids</span>:[<span class="number">4</span>]&#125;,</span><br><span class="line">    &#123;<span class="attr">id</span>:<span class="number">3</span>, <span class="attr">label</span>:<span class="string">&quot;羽毛球&quot;</span>, <span class="attr">group</span>:<span class="number">2</span>, <span class="attr">pid</span>:<span class="number">1</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">id</span>:<span class="number">4</span>, <span class="attr">label</span>:<span class="string">&quot;技巧&quot;</span>, <span class="attr">group</span>:<span class="number">3</span>,<span class="attr">pid</span>:<span class="number">2</span>&#125;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> staticEdges = [</span><br><span class="line">    &#123;<span class="attr">id</span>:<span class="number">1</span>,<span class="attr">label</span>:<span class="string">&quot;兴趣&quot;</span>, <span class="attr">from</span>: <span class="number">1</span>,<span class="attr">to</span>: <span class="number">2</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">id</span>:<span class="number">2</span>,<span class="attr">label</span>:<span class="string">&quot;兴趣&quot;</span>, <span class="attr">from</span>: <span class="number">1</span>,<span class="attr">to</span>: <span class="number">3</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">id</span>:<span class="number">3</span>,<span class="attr">label</span>:<span class="string">&quot;有&quot;</span>, <span class="attr">from</span>: <span class="number">2</span>,<span class="attr">to</span>: <span class="number">4</span>&#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h2 id="1-2-数据格式"><a href="#1-2-数据格式" class="headerlink" title="1.2 数据格式"></a>1.2 数据格式</h2><h3 id="1-2-1-格式要求"><a href="#1-2-1-格式要求" class="headerlink" title="1.2.1 格式要求"></a>1.2.1 格式要求</h3><ul>
<li>一般vis要显示network，需要以下格式<ul>
<li>node：id、label、group</li>
<li>edge：id、label、from、to</li>
</ul>
</li>
<li>为了实现节点展开收缩就需要在nodes中再添加两个字段：<ul>
<li>pid：父节点id</li>
<li>subids：子节点id列表</li>
</ul>
</li>
</ul>
<h3 id="1-2-2-后端实现方案（首页展示）："><a href="#1-2-2-后端实现方案（首页展示）：" class="headerlink" title="1.2.2 后端实现方案（首页展示）："></a>1.2.2 后端实现方案（首页展示）：</h3><ul>
<li>需要先给数据分层，添加level标签，表示层级关系，只需要标注第一层即可，因为其他层会因点击事件而进行展开</li>
<li>nodes节点中的pid和subids需要进行判断，再进行添加<ul>
<li>设置pid：根据关系进行判断（根据to，查找from），对于单向关系，比如（我，有，篮球），那么篮球的pid就设置为“我”的id值，<strong>注意：目前只考虑节点的父节点只有一个的情况，如果pid有多个就需要设置列表</strong></li>
<li>设置subids：根据关系进行判断（根据from，查找to），如存在一组关系（我，有，篮球）、（我，年龄，18），那么“我”的subids即表示为“篮球”和“18”对应id组成的列表</li>
<li>设置group：group是为了对节点进行区分<ul>
<li>前端实现：在进行节点展开时，会为nodes添加节点数据，这里就可以为节点添加上相同group，可以取一个随机整数</li>
<li>后端实现：对于关系中from标签相同的一组关系，为其to标签对应的节点添加上相同group值</li>
</ul>
</li>
</ul>
</li>
<li>为vis注入数据时，先注入第一层的数据，即先显示第一层的节点关系</li>
</ul>
<h1 id="二、vis-js绘制network"><a href="#二、vis-js绘制network" class="headerlink" title="二、vis.js绘制network"></a>二、vis.js绘制network</h1><h2 id="2-1-将数据注入到vis中"><a href="#2-1-将数据注入到vis中" class="headerlink" title="2.1 将数据注入到vis中"></a>2.1 将数据注入到vis中</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> nodes = <span class="keyword">new</span> vis.DataSet(staticNodes);</span><br><span class="line"><span class="keyword">var</span> edges = <span class="keyword">new</span> vis.DataSet(staticEdges);</span><br></pre></td></tr></table></figure>
<h2 id="2-2-配置network"><a href="#2-2-配置network" class="headerlink" title="2.2 配置network"></a>2.2 配置network</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个图的容器</span></span><br><span class="line"><span class="keyword">var</span> container = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;mynetwork&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> data = &#123;</span><br><span class="line">    <span class="attr">nodes</span>: nodes,</span><br><span class="line">    <span class="attr">edges</span>: edges</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> options = &#123;</span><br><span class="line">    <span class="attr">nodes</span>:&#123;</span><br><span class="line">        <span class="attr">shape</span>: <span class="string">&quot;dot&quot;</span>,</span><br><span class="line">        <span class="comment">// scaling: &#123;</span></span><br><span class="line">        <span class="comment">//     customScalingFunction: function(min, max, total, value)&#123;</span></span><br><span class="line">        <span class="comment">//         return value / total;</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     min:5,</span></span><br><span class="line">        <span class="comment">//     max:150,</span></span><br><span class="line">        <span class="comment">// &#125;,</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">edges</span>: &#123;</span><br><span class="line">        <span class="attr">width</span>: <span class="number">0.15</span>,</span><br><span class="line">        <span class="comment">//physics: false,</span></span><br><span class="line">        <span class="attr">smooth</span>: &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&quot;continuous&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="attr">interaction</span>: &#123;</span><br><span class="line">        <span class="attr">hover</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="comment">//hoverConnectedEdges: true</span></span><br><span class="line">        <span class="comment">//hideEdgesOnDrag: true,</span></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="attr">physics</span>: &#123;</span><br><span class="line">        <span class="comment">//enabled: false,</span></span><br><span class="line">        <span class="attr">repulsion</span>:&#123;</span><br><span class="line">            <span class="attr">nodeDistance</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">springLength</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">springConstant</span>: <span class="number">0.5</span>,</span><br><span class="line">            <span class="attr">centralGravity</span>: <span class="number">0.9</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="attr">layout</span>:&#123;</span><br><span class="line">        <span class="comment">//hierarchical: &#123;direction: &#x27;UD&#x27;, sortMethod: &#x27;hubsize&#x27;&#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 图可视化</span></span><br><span class="line"><span class="comment">// initialize your network!</span></span><br><span class="line"><span class="keyword">var</span> network = <span class="keyword">new</span> vis.Network(container, data, options);</span><br></pre></td></tr></table></figure>
<h2 id="2-3-为节点创建点击事件"><a href="#2-3-为节点创建点击事件" class="headerlink" title="2.3 为节点创建点击事件"></a>2.3 为节点创建点击事件</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 点击事件获取的是节点的列表，一般列表中只有一个节点id</span></span><br><span class="line">network.on(<span class="string">&#x27;click&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">params</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// 点击的是节点的情况（不考虑点击边的情况）</span></span><br><span class="line">    <span class="keyword">if</span> (params.nodes.length != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> clickNodeId = params.nodes[<span class="number">0</span>];</span><br><span class="line">        <span class="comment">//console.log(findArrayIndexById(staticNodes,clickNodeId));</span></span><br><span class="line">        <span class="comment">//removeSubNodes(clickNodeId);</span></span><br><span class="line">        <span class="comment">//removeByRecur(clickNodeId)</span></span><br><span class="line">        <span class="comment">//console.log(nodes.get(1));</span></span><br><span class="line">		</span><br><span class="line">        <span class="comment">//	逻辑分离，如果点击的节点存在子节点，则递归收缩节点</span></span><br><span class="line">        <span class="comment">//	否则进行节点展开</span></span><br><span class="line">        <span class="keyword">if</span>(getSubNodes(clickNodeId).length!=<span class="number">0</span>)</span><br><span class="line">            removeNodes(clickNodeId);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            addNodes(clickNodeId);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h1 id="三、展开收缩逻辑"><a href="#三、展开收缩逻辑" class="headerlink" title="三、展开收缩逻辑"></a>三、展开收缩逻辑</h1><ul>
<li>具体的逻辑实现如下：<ul>
<li>第一步：<strong>getSubNodes</strong>函数获取到点击节点的<strong>下级节点id列表</strong>subNodes</li>
<li>第二步：判断<strong>subNodes</strong>是否为空，如果<strong>不为空</strong>执行<strong>第三步</strong>，否则执行第四步</li>
<li>第三步：如果不为空：遍历subNodes中的id值，在<strong>staticNodes</strong>中找到其对应的节点并在nodes/edges中进行递归remove<strong>（收缩操作）</strong></li>
<li>第四步：如果为空：判断点击的节点是否存在<strong>下级节点列表subids</strong>，如果存在，执行第五步<strong>（展开操作）</strong></li>
<li>第五步：遍历<strong>subids下级id列表</strong>，在staticNodes中查找到对应的节点，添加到nodes和edges中，实现节点的展开操作</li>
</ul>
</li>
<li>收缩时，如果点击节点的下一级节点中包含下下一级节点，则进行递归查找并收缩，实现方法为<strong>removeNodes</strong></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 根据id值查找其对应的下标</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">findArrayIndexById</span>(<span class="params">arr, id</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> res;</span><br><span class="line">    $.each(arr, <span class="function">(<span class="params">index,item</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(item[<span class="string">&#x27;id&#x27;</span>] == id)&#123;</span><br><span class="line">            res = index;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 节点收缩</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">removeNodes</span>(<span class="params">clickNodeId</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// 获取到的是下级节点列表</span></span><br><span class="line">    <span class="keyword">var</span> subNodes = getSubNodes(clickNodeId);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//如果获取的下级节点列表长度 不为 0，表示节点没有收缩，则点击后进行收缩</span></span><br><span class="line">    <span class="keyword">if</span>(subNodes.length != <span class="number">0</span>)&#123;</span><br><span class="line">        $.each(subNodes,<span class="function">(<span class="params">index,item</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="comment">//消除的是注入到vis中的数据，而不是staticNodes/Edges</span></span><br><span class="line">            removeNodes(item);</span><br><span class="line">            nodes.remove(&#123;<span class="attr">id</span>:item&#125;);</span><br><span class="line">            edges.remove(&#123;<span class="attr">from</span>:clickNodeId,<span class="attr">to</span>:item&#125;);</span><br><span class="line"></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//节点展开</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addNodes</span>(<span class="params">clickNodeId</span>)</span>&#123;</span><br><span class="line">    $.each(staticNodes[findArrayIndexById(staticNodes,clickNodeId)][<span class="string">&#x27;subids&#x27;</span>],<span class="function">(<span class="params">index,item</span>)=&gt;</span>&#123;</span><br><span class="line">        nodes.add(staticNodes[findArrayIndexById(staticNodes,item)]);</span><br><span class="line">        edges.add(&#123;<span class="attr">from</span>: clickNodeId,<span class="attr">to</span>: item&#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取点击节点的下级节点列表，不包含与其相连的父节点id</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getSubNodes</span>(<span class="params">clickNodeId</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// 获取与该节点所连接的所有节点的id（只要是相连的都会被算进来）</span></span><br><span class="line">    <span class="keyword">var</span> returnNodes = [];</span><br><span class="line">    <span class="keyword">var</span> connectedNodes = network.getConnectedNodes(clickNodeId);<span class="comment">//获取所有连接节点</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 对节点id列表进行遍历，index表示列表下标，item表示对应的id值</span></span><br><span class="line">    $.each(connectedNodes, <span class="function">(<span class="params">index,item</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="comment">//这里的clickNodeId和staticNodes数组中的下标只是简单的-1操作</span></span><br><span class="line">        <span class="comment">//因为staticNodes中id都是顺序的，如果不是顺序的就需要遍历才能找到其下标值</span></span><br><span class="line">        <span class="comment">//clickNodeId是点击的那个节点的id，item是连接节点的id</span></span><br><span class="line">        <span class="comment">//如果这个连接的节点是点击的节点父节点，则不考虑进去！！！</span></span><br><span class="line">        <span class="keyword">if</span>(item != staticNodes[findArrayIndexById(staticNodes,clickNodeId)][<span class="string">&#x27;pid&#x27;</span>])&#123;</span><br><span class="line">            returnNodes.push(item);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> returnNodes;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="四、实现效果"><a href="#四、实现效果" class="headerlink" title="四、实现效果"></a>四、实现效果</h1><img src="/2022/03/12/%E5%89%8D%E7%AB%AF%E7%BB%84%E4%BB%B6%E5%AE%9E%E7%8E%B0-%E5%9F%BA%E4%BA%8Evis-js%E7%9A%84%E8%8A%82%E7%82%B9%E5%B1%95%E5%BC%80/node.gif" class="" title="image1">
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="故事开头"
      src="/images/yue.jpeg">
  <p class="site-author-name" itemprop="name">故事开头</p>
  <div class="site-description" itemprop="description">一个穷鬼</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">34</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">23</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">59</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>
	  
	  
		<script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
		<script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
		<div class="widget-wrap">
			<h3 class="widget-title">Tag Cloud</h3>
			<div id="myCanvasContainer" class="widget tagcloud">
				<canvas width="250" height="250" id="resCanvas" style="width=100%">
					<ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ARQ/" rel="tag">ARQ</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C-%E8%84%9A%E6%9C%AC/" rel="tag">C#脚本</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS3/" rel="tag">CSS3</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML5/" rel="tag">HTML5</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java%E5%AE%B9%E5%99%A8/" rel="tag">Java容器</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java%E6%B3%9B%E5%9E%8B/" rel="tag">Java泛型</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java%E6%B3%A8%E8%A7%A3/" rel="tag">Java注解</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jena/" rel="tag">Jena</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/KEPServer/" rel="tag">KEPServer</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux%E5%91%BD%E4%BB%A4/" rel="tag">Linux命令</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mysql/" rel="tag">Mysql</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OPC-UA/" rel="tag">OPC UA</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OWL/" rel="tag">OWL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/" rel="tag">Redis</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SPARQL/" rel="tag">SPARQL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SSM/" rel="tag">SSM</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring/" rel="tag">Spring</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringMVC/" rel="tag">SpringMVC</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Springboot/" rel="tag">Springboot</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vue2/" rel="tag">Vue2</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/" rel="tag">js</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/milo/" rel="tag">milo</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/springboot/" rel="tag">springboot</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/unity3d/" rel="tag">unity3d</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vis-js/" rel="tag">vis.js</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue/" rel="tag">vue</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/" rel="tag">个人项目</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AD%E5%9B%BD%E4%BC%A0%E7%BB%9F/" rel="tag">中国传统</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B9%90%E7%90%86/" rel="tag">乐理</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/" rel="tag">前后端分离</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF/" rel="tag">前端</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%90%89%E4%BB%96%E9%9F%B3%E9%98%B6%E5%88%86%E5%B8%83/" rel="tag">吉他音阶分布</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%90%8E%E7%AB%AF/" rel="tag">后端</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%90%8E%E7%AB%AF%E6%A1%86%E6%9E%B6/" rel="tag">后端框架</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%92%8C%E5%BC%A6/" rel="tag">和弦</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%92%8C%E5%BC%A6%E8%BF%9B%E8%A1%8C/" rel="tag">和弦进行</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" rel="tag">微服务</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BB%BA%E6%A8%A1/" rel="tag">数据建模</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/" rel="tag">服务器</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%9F%E5%88%8A/" rel="tag">期刊</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/" rel="tag">游戏开发</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/" rel="tag">知识图谱</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E5%BA%94%E7%94%A8/" rel="tag">知识图谱应用</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E6%9E%84%E5%BB%BA/" rel="tag">知识图谱构建</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%BC%E8%BF%B0/" rel="tag">综述</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E7%A8%8B%E8%89%BA%E6%9C%AF/" rel="tag">编程艺术</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E9%A1%B5%E6%95%88%E6%9E%9C/" rel="tag">网页效果</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BA%E6%96%87/" rel="tag">论文</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BA%E6%96%87%E6%8A%95%E7%A8%BF/" rel="tag">论文投稿</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BA%E6%96%87%E6%A0%BC%E5%BC%8F/" rel="tag">论文格式</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AF%97%E8%AF%8D/" rel="tag">诗词</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B0%83%E5%BC%8F/" rel="tag">调式</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95/" rel="tag">面试</a><span class="tag-list-count">1</span></li></ul>
				</canvas>
			</div>
		</div>
	  

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">故事开头</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>


    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <span >总访问量: <span id="busuanzi_value_site_pv"></span>次</span>
    <span class="post-meta-divider">|</span>
    <span >总访问量: <span id="busuanzi_value_site_uv"></span>次</span>
    <span class="post-meta-divider">|</span>



        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false});</script></body>
</html>
